{
  "name": "microsoft-windows-server-2019-stig-baseline",
  "title": "microsoft-windows-server-2019-stig-baseline",
  "maintainer": "The Authors",
  "copyright": "The Authors",
  "copyright_email": "you@example.com",
  "license": "Apache-2.0",
  "summary": "Inspec Validation Profile for Microsoft Windows Member Server 2019 STIG",
  "version": "1.3.24",
  "inspec_version": ">= 4.0",
  "inputs": [
    {
      "name": "org_name",
      "options": {
        "type": "Hash",
        "value": { "acronym": "DoD", "full_form": "Department of Defense" }
      }
    },
    {
      "name": "temp_accounts_domain",
      "options": { "type": "Array", "value": [null] }
    },
    {
      "name": "temp_accounts_local",
      "options": { "type": "Array", "value": [null] }
    },
    {
      "name": "temporary_account_period",
      "options": { "type": "Numeric", "value": 3 }
    },
    {
      "name": "temporary_account_period_phrase",
      "options": { "type": "String", "value": "72 hours" }
    },
    {
      "name": "emergency_accounts_domain",
      "options": { "type": "Array", "value": [null] }
    },
    {
      "name": "emergency_accounts_local",
      "options": { "type": "Array", "value": [null] }
    },
    {
      "name": "emergency_account_period",
      "options": { "type": "Numeric", "value": 3 }
    },
    {
      "name": "emergency_account_period_phrase",
      "options": { "type": "String", "value": "72 hours" }
    },
    {
      "name": "max_pass_lockout",
      "options": { "type": "Numeric", "value": 3 }
    },
    { "name": "pass_lock_time", "options": { "type": "Numeric", "value": 15 } },
    {
      "name": "pass_lock_duration",
      "options": { "type": "Numeric", "value": 15 }
    },
    {
      "name": "app_password_age",
      "options": { "type": "Numeric", "value": 365 }
    },
    {
      "name": "maximum_password_age_machine",
      "options": { "type": "Numeric", "value": 30 }
    },
    {
      "name": "maximum_idle_time",
      "options": { "type": "Numeric", "value": 300 }
    },
    {
      "name": "maximum_idle_time_phrase",
      "options": { "type": "String", "value": "5 minutes" }
    },
    {
      "name": "unused_account_age",
      "options": { "type": "Numeric", "value": 35 }
    },
    {
      "name": "minimum_password_length_manual",
      "options": { "type": "Numeric", "value": 15 }
    },
    {
      "name": "minimum_password_length",
      "options": { "type": "Numeric", "value": 14 }
    },
    {
      "name": "minimum_password_age",
      "options": { "type": "Numeric", "value": 1 }
    },
    {
      "name": "maximum_password_age",
      "options": { "type": "Numeric", "value": 60 }
    },
    {
      "name": "password_history_size",
      "options": { "type": "Numeric", "value": 24 }
    },
    {
      "name": "enable_password_complexity",
      "options": { "type": "Numeric", "value": 1 }
    },
    {
      "name": "allowed_network_access_users",
      "options": {
        "type": "Array",
        "value": ["S-1-5-32-544", "S-1-5-11", "S-1-5-9"]
      }
    },
    {
      "name": "disallowed_network_access_users",
      "options": { "type": "Array", "value": [null] }
    },
    {
      "name": "allowed_global_privilege_users",
      "options": {
        "type": "Array",
        "value": ["S-1-5-32-544", "S-1-5-6", "S-1-5-19", "S-1-5-20"],
        "sensitive": true
      }
    },
    {
      "name": "disallowed_global_privilege_users",
      "options": { "type": "Array", "value": [null] }
    },
    {
      "name": "allowed_audit_privilege_users",
      "options": {
        "type": "Array",
        "value": ["S-1-5-19", "S-1-5-20"],
        "sensitive": true
      }
    },
    {
      "name": "disallowed_audit_privilege_users",
      "options": { "type": "Array", "value": [null] }
    },
    {
      "name": "c_perm",
      "options": {
        "type": "Array",
        "value": [
          "NT AUTHORITY\\\\SYSTEM:(OI)(CI)(F)",
          "BUILTIN\\Administrators:(OI)(CI)(F)",
          "BUILTIN\\Users:(OI)(CI)(RX)",
          "BUILTIN\\Users:(CI)(AD)",
          "BUILTIN\\Users:(CI)(IO)(WD)",
          "CREATOR OWNER:(OI)(CI)(IO)(F)"
        ]
      }
    },
    {
      "name": "c_program_files_perm",
      "options": {
        "type": "Array",
        "value": [
          "NT SERVICE\\TrustedInstaller:(F)",
          "NT SERVICE\\TrustedInstaller:(CI)(IO)(F)",
          "NT AUTHORITY\\SYSTEM:(M)",
          "NT AUTHORITY\\SYSTEM:(OI)(CI)(IO)(F)",
          "BUILTIN\\Administrators:(M)",
          "BUILTIN\\Administrators:(OI)(CI)(IO)(F)",
          "BUILTIN\\Users:(RX)",
          "BUILTIN\\Users:(OI)(CI)(IO)(GR,GE)",
          "CREATOR OWNER:(OI)(CI)(IO)(F)",
          "APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES:(RX)",
          "APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES:(OI)(CI)(IO)(GR,GE)",
          "APPLICATION PACKAGE AUTHORITY\\ALL RESTRICTED APPLICATION PACKAGES:(RX)",
          "APPLICATION PACKAGE AUTHORITY\\ALL RESTRICTED APPLICATION PACKAGES:(OI)(CI)(IO)(GR,GE)"
        ]
      }
    },
    {
      "name": "c_windows_perm",
      "options": {
        "type": "Array",
        "value": [
          "NT SERVICE\\TrustedInstaller:(F)",
          "NT SERVICE\\TrustedInstaller:(CI)(IO)(F)",
          "NT AUTHORITY\\SYSTEM:(M)",
          "NT AUTHORITY\\SYSTEM:(OI)(CI)(IO)(F)",
          "BUILTIN\\Administrators:(M)",
          "BUILTIN\\Administrators:(OI)(CI)(IO)(F)",
          "BUILTIN\\Users:(RX)",
          "BUILTIN\\Users:(OI)(CI)(IO)(GR,GE)",
          "CREATOR OWNER:(OI)(CI)(IO)(F)",
          "APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES:(RX)",
          "APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES:(OI)(CI)(IO)(GR,GE)",
          "APPLICATION PACKAGE AUTHORITY\\ALL RESTRICTED APPLICATION PACKAGES:(RX)",
          "APPLICATION PACKAGE AUTHORITY\\ALL RESTRICTED APPLICATION PACKAGES:(OI)(CI)(IO)(GR,GE)"
        ]
      }
    },
    {
      "name": "reg_software_perms",
      "options": {
        "type": "Array",
        "value": [
          "CREATOR OWNER Allow  FullControl",
          "NT AUTHORITY\\SYSTEM Allow  FullControl",
          "BUILTIN\\Administrators Allow  FullControl",
          "BUILTIN\\Users Allow  ReadKey",
          "APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES Allow  ReadKey",
          "S-1-15-3-1024-1065365936-1281604716-3511738428-1654721687-432734479-3232135806-4053264122-3456934681 Allow  ReadKey"
        ]
      }
    },
    {
      "name": "reg_system_perms_dc",
      "options": {
        "value": [
          "CREATOR OWNER Allow  268435456",
          "NT AUTHORITY\\SYSTEM Allow  268435456",
          "NT AUTHORITY\\SYSTEM Allow  FullControl",
          "BUILTIN\\Administrators Allow  268435456",
          "BUILTIN\\Administrators Allow  FullControl",
          "BUILTIN\\Server Operators Allow ReadKey",
          "BUILTIN\\Users Allow  ReadKey",
          "APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES Allow  ReadKey",
          "APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES Allow  -2147483648",
          "S-1-15-3-1024-1065365936-1281604716-3511738428-1654721687-432734479-3232135806-4053264122-3456934681 Allow  ReadKey",
          "S-1-15-3-1024-1065365936-1281604716-3511738428-1654721687-432734479-3232135806-4053264122-3456934681 Allow  -2147483648"
        ]
      }
    },
    {
      "name": "reg_security_perms",
      "options": {
        "type": "Array",
        "value": [
          "NT AUTHORITY\\SYSTEM Allow  FullControl",
          "BUILTIN\\Administrators Allow  ReadPermissions, ChangePermissions"
        ]
      }
    },
    {
      "name": "reg_system_perms",
      "options": {
        "type": "Array",
        "value": [
          "CREATOR OWNER Allow  268435456",
          "NT AUTHORITY\\SYSTEM Allow  268435456",
          "NT AUTHORITY\\SYSTEM Allow  FullControl",
          "BUILTIN\\Administrators Allow  268435456",
          "BUILTIN\\Administrators Allow  FullControl",
          "BUILTIN\\Users Allow  -2147483648",
          "BUILTIN\\Users Allow  ReadKey",
          "APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES Allow  ReadKey",
          "APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES Allow  -2147483648",
          "S-1-15-3-1024-1065365936-1281604716-3511738428-1654721687-432734479-3232135806-4053264122-3456934681 Allow  ReadKey",
          "S-1-15-3-1024-1065365936-1281604716-3511738428-1654721687-432734479-3232135806-4053264122-3456934681 Allow  -2147483648"
        ]
      }
    },
    {
      "name": "local_administrators_dc",
      "options": { "type": "Array", "value": [null] }
    },
    {
      "name": "local_administrators_member",
      "options": { "type": "Array", "value": [null], "sensitive": true }
    },
    {
      "name": "local_administrator",
      "options": { "type": "String", "value": "", "sensitive": true }
    },
    {
      "name": "ntds_permissions",
      "options": {
        "type": "Array",
        "value": [
          "BUILTIN\\Administrators:(I)(F)",
          "NT AUTHORITY\\SYSTEM:(I)(F)"
        ]
      }
    },
    {
      "name": "c_windows_sysvol_perm",
      "options": {
        "type": "Array",
        "value": [
          "NT AUTHORITY\\Authenticated Users:(RX)",
          "NT AUTHORITY\\Authenticated Users:(OI)(CI)(IO)(GR,GE)",
          "BUILTIN\\Server Operators:(RX)",
          "BUILTIN\\Server Operators:(OI)(CI)(IO)(GR,GE)",
          "BUILTIN\\Administrators:(M,WDAC,WO)",
          "BUILTIN\\Administrators:(OI)(CI)(IO)(F)",
          "NT AUTHORITY\\SYSTEM:(F)",
          "NT AUTHORITY\\SYSTEM:(OI)(CI)(IO)(F)",
          "NT AUTHORITY\\SYSTEM:(M,WDAC,WO)",
          "CREATOR OWNER:(OI)(CI)(IO)(F)"
        ]
      }
    },
    {
      "name": "LegalNoticeText",
      "options": {
        "type": "String",
        "value": "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions: -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations. -At any time, the USG may inspect and seize data stored on this IS. -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose. -This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants.  Such communications and work product are private and confidential.  See User Agreement for details."
      }
    },
    {
      "name": "LegalNoticeCaption",
      "options": {
        "type": "Array",
        "value": [
          "DoD Notice and Consent Banner",
          "US Department of Defense Warning Statement"
        ]
      }
    },
    {
      "name": "winevt_logs_application_perms",
      "options": {
        "type": "Array",
        "value": [
          "NT SERVICE\\EventLog Allow  FullControl",
          "NT AUTHORITY\\SYSTEM Allow  FullControl",
          "BUILTIN\\Administrators Allow  FullControl"
        ]
      }
    },
    {
      "name": "winevt_logs_security_perms",
      "options": {
        "type": "Array",
        "value": [
          "NT SERVICE\\EventLog Allow  FullControl",
          "NT AUTHORITY\\SYSTEM Allow  FullControl",
          "BUILTIN\\Administrators Allow  FullControl"
        ]
      }
    },
    {
      "name": "winevt_logs_system_perms",
      "options": {
        "type": "Array",
        "value": [
          "NT SERVICE\\EventLog Allow  FullControl",
          "NT AUTHORITY\\SYSTEM Allow  FullControl",
          "BUILTIN\\Administrators Allow  FullControl"
        ]
      }
    },
    {
      "name": "eventvwr_perms",
      "options": {
        "type": "Array",
        "value": [
          "NT AUTHORITY\\SYSTEM Allow  ReadAndExecute, Synchronize",
          "BUILTIN\\Administrators Allow  ReadAndExecute, Synchronize",
          "BUILTIN\\Users Allow  ReadAndExecute, Synchronize",
          "NT SERVICE\\TrustedInstaller Allow  FullControl",
          "APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES Allow  ReadAndExecute, Synchronize",
          "APPLICATION PACKAGE AUTHORITY\\ALL RESTRICTED APPLICATION PACKAGES Allow  ReadAndExecute, Synchronize"
        ]
      }
    },
    {
      "name": "backup_operators",
      "options": { "type": "Array", "value": [null] }
    },
    {
      "name": "application_accounts_domain",
      "options": { "type": "Array", "value": [null] }
    },
    {
      "name": "excluded_accounts_domain",
      "options": { "type": "Array", "value": [null] }
    },
    {
      "name": "application_accounts_local",
      "options": { "type": "Array", "value": [null] }
    },
    {
      "name": "excluded_accounts_local",
      "options": { "type": "Array", "value": [null] }
    },
    {
      "name": "av_approved_software",
      "options": {
        "type": "Array",
        "value": [
          "Windows Defender",
          "McAfee Host Intrusion Prevention",
          "McAfee Endpoint Security",
          "McAfee Agent"
        ]
      }
    },
    {
      "name": "sensitive_system",
      "options": { "type": "Boolean", "value": false }
    },
    { "name": "ftp_server", "options": { "type": "Boolean", "value": false } },
    { "name": "ntp_servers", "options": { "type": "Array", "value": [null] } },
    {
      "name": "dod_root_certificates",
      "options": {
        "type": "Array",
        "value": [
          {
            "Subject": "CN=DoD Root CA 2, OU=PKI, OU=DoD, O=U.S. Government, C=US",
            "Thumbprint": "8C941B34EA1EA6ED9AE2BC54CF687252B4C9B561",
            "NotAfter": "Wednesday, December 05, 2029"
          },
          {
            "Subject": "CN=DoD Root CA 3, OU=PKI, OU=DoD, O=U.S. Government, C=US",
            "Thumbprint": "D73CA91102A2204A36459ED32213B467D7CE97FB",
            "NotAfter": "Sunday, December 30, 2029"
          },
          {
            "Subject": "CN=DoD Root CA 4, OU=PKI, OU=DoD, O=U.S. Government, C=US",
            "Thumbprint": "B8269F25DBD937ECAFD4C35A9838571723F2D026",
            "NotAfter": "Sunday, July 25, 2032"
          },
          {
            "Subject": "CN=DoD Root CA 5, OU=PKI, OU=DoD, O=U.S. Government, C=US",
            "Thumbprint": "4ECB5CC3095670454DA1CBD410FC921F46B8564B",
            "NotAfter": "Friday, June 14, 2041"
          }
        ]
      }
    },
    {
      "name": "dod_interoperability_certificates",
      "options": {
        "type": "Array",
        "value": [
          {
            "Subject": "CN=DoD Root CA 2, OU=PKI, OU=DoD, O=U.S. Government, C=US",
            "Issuer": "CN=DoD Interoperability Root CA 1, OU=PKI, OU=DoD, O=U.S. Government, C=US",
            "Thumbprint": "22BBE981F0694D246CC1472ED2B021DC8540A22F",
            "NotAfter": "Friday, September 06, 2019"
          },
          {
            "Subject": "CN=DoD Root CA 3, OU=PKI, OU=DoD, O=U.S. Government, C=US",
            "Issuer": "CN=DoD Interoperability Root CA 2, OU=PKI, OU=DoD, O=U.S. Government, C=US",
            "Thumbprint": "AC06108CA348CC03B53795C64BF84403C1DBD341",
            "NotAfter": "Saturday, January 22, 2022"
          }
        ]
      }
    },
    {
      "name": "dod_cceb_certificates",
      "options": {
        "type": "Array",
        "value": [
          {
            "Subject": "CN=DoD Root CA 3, OU=PKI, OU=DoD, O=U.S. Government, C=US",
            "Issuer": "CN=US DoD CCEB Interoperability Root CA 2, OU=PKI, OU=DoD, O=U.S. Government, C=US",
            "Thumbprint": "929BF3196896994C0A201DF4A5B71F603FEFBF2E",
            "NotAfter": "Friday, September 27, 2019"
          }
        ]
      }
    },
    {
      "name": "administrators",
      "options": { "type": "Array", "value": [null], "sensitive": true }
    },
    {
      "name": "disable_slow_controls",
      "options": {
        "value": "Input 'disable_slow_controls' does not have a value. Skipping test."
      }
    },
    {
      "name": "exempt_home_users",
      "options": {
        "value": "Input 'exempt_home_users' does not have a value. Skipping test."
      }
    },
    {
      "name": "non_interactive_shells",
      "options": {
        "value": "Input 'non_interactive_shells' does not have a value. Skipping test."
      }
    }
  ],
  "supports": [],
  "controls": [
    {
      "title": "Windows Server 2019 permissions for the system drive root directory\n  (usually C:\\) must conform to minimum requirements.",
      "desc": "Changing the system's file and directory permissions allows the\n  possibility of unauthorized and anonymous modification to the operating system\n  and installed applications.\n\n      The default permissions are adequate when the Security Option \"Network\n  access: Let Everyone permissions apply to anonymous users\" is set to\n  \"Disabled\" (WN19-SO-000240).",
      "descriptions": {
        "default": "Changing the system's file and directory permissions allows the\n  possibility of unauthorized and anonymous modification to the operating system\n  and installed applications.\n\n      The default permissions are adequate when the Security Option \"Network\n  access: Let Everyone permissions apply to anonymous users\" is set to\n  \"Disabled\" (WN19-SO-000240).",
        "rationale": "",
        "check": "The default permissions are adequate when the Security Option \"Network\n  access: Let Everyone permissions apply to anonymous users\" is set to\n  \"Disabled\" (WN19-SO-000240).\n\n      Review the permissions for the system drive's root directory (usually\n  C:). Non-privileged groups such as Users or Authenticated Users must not have\n  greater than \"Read & execute\" permissions except where noted as defaults.\n  Individual accounts must not be used to assign permissions.\n\n      If permissions are not as restrictive as the default permissions listed\n  below, this is a finding.\n\n      Viewing in File Explorer:\n\n      View the Properties of the system drive's root directory.\n\n      Select the \"Security\" tab, and the \"Advanced\" button.\n\n      Default permissions:\n      C:\\\n      Type - \"Allow\" for all\n      Inherited from - \"None\" for all\n\n      Principal - Access - Applies to\n\n      SYSTEM - Full control - This folder, subfolders, and files\n      Administrators - Full control - This folder, subfolders, and files\n      Users - Read & execute - This folder, subfolders, and files\n      Users - Create folders/append data - This folder and subfolders\n      Users - Create files/write data - Subfolders only\n      CREATOR OWNER - Full Control - Subfolders and files only\n\n      Alternately, use icacls:\n\n      Open \"Command Prompt (Admin)\".\n\n      Enter \"icacls\" followed by the directory:\n\n      \"icacls c:\\\"\n\n      The following results should be displayed:\n\n      c:\\\n      NT AUTHORITY\\SYSTEM:(OI)(CI)(F)\n      BUILTIN\\Administrators:(OI)(CI)(F)\n      BUILTIN\\Users:(OI)(CI)(RX)\n      BUILTIN\\Users:(CI)(AD)\n      BUILTIN\\Users:(CI)(IO)(WD)\n      CREATOR OWNER:(OI)(CI)(IO)(F)\n      Successfully processed 1 files; Failed processing 0 files",
        "fix": "Maintain the default permissions for the system drive's root directory and\nconfigure the Security Option \"Network access: Let Everyone permissions apply\nto anonymous users\" to \"Disabled\" (WN19-SO-000240).\n\n    Default Permissions\n    C:\\\n    Type - \"Allow\" for all\n    Inherited from - \"None\" for all\n\n    Principal - Access - Applies to\n\n    SYSTEM - Full control - This folder, subfolders, and files\n    Administrators - Full control - This folder, subfolders, and files\n    Users - Read & execute - This folder, subfolders, and files\n    Users - Create folders/append data - This folder and subfolders\n    Users - Create files/write data - Subfolders only\n    CREATOR OWNER - Full Control - Subfolders and files only"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": null,
        "gtitle": "SRG-OS-000312-GPOS-00122",
        "satisfies": [
          "SRG-OS-000312-GPOS-00122",
          "SRG-OS-000312-GPOS-00123",
          "SRG-OS-000312-GPOS-00124"
        ],
        "gid": "V-93019",
        "rid": "SV-103107r1_rule",
        "stig_id": "WN19-00-000140",
        "fix_id": "F-99265r1_fix",
        "cci": ["CCI-002165"],
        "nist": ["AC-3 (4)", "Rev_4"]
      },
      "code": "control 'V-93019' do\n  title \"Windows Server 2019 permissions for the system drive root directory\n  (usually C:\\\\) must conform to minimum requirements.\"\n  desc \"Changing the system's file and directory permissions allows the\n  possibility of unauthorized and anonymous modification to the operating system\n  and installed applications.\n\n      The default permissions are adequate when the Security Option \\\"Network\n  access: Let Everyone permissions apply to anonymous users\\\" is set to\n  \\\"Disabled\\\" (WN19-SO-000240).\"\n  desc  'rationale', ''\n  desc  'check', \"The default permissions are adequate when the Security Option \\\"Network\n  access: Let Everyone permissions apply to anonymous users\\\" is set to\n  \\\"Disabled\\\" (WN19-SO-000240).\n\n      Review the permissions for the system drive's root directory (usually\n  C:\\). Non-privileged groups such as Users or Authenticated Users must not have\n  greater than \\\"Read & execute\\\" permissions except where noted as defaults.\n  Individual accounts must not be used to assign permissions.\n\n      If permissions are not as restrictive as the default permissions listed\n  below, this is a finding.\n\n      Viewing in File Explorer:\n\n      View the Properties of the system drive's root directory.\n\n      Select the \\\"Security\\\" tab, and the \\\"Advanced\\\" button.\n\n      Default permissions:\n      C:\\\\\n      Type - \\\"Allow\\\" for all\n      Inherited from - \\\"None\\\" for all\n\n      Principal - Access - Applies to\n\n      SYSTEM - Full control - This folder, subfolders, and files\n      Administrators - Full control - This folder, subfolders, and files\n      Users - Read & execute - This folder, subfolders, and files\n      Users - Create folders/append data - This folder and subfolders\n      Users - Create files/write data - Subfolders only\n      CREATOR OWNER - Full Control - Subfolders and files only\n\n      Alternately, use icacls:\n\n      Open \\\"Command Prompt (Admin)\\\".\n\n      Enter \\\"icacls\\\" followed by the directory:\n\n      \\\"icacls c:\\\\\\\"\n\n      The following results should be displayed:\n\n      c:\\\\\n      NT AUTHORITY\\\\SYSTEM:(OI)(CI)(F)\n      BUILTIN\\\\Administrators:(OI)(CI)(F)\n      BUILTIN\\\\Users:(OI)(CI)(RX)\n      BUILTIN\\\\Users:(CI)(AD)\n      BUILTIN\\\\Users:(CI)(IO)(WD)\n      CREATOR OWNER:(OI)(CI)(IO)(F)\n      Successfully processed 1 files; Failed processing 0 files\"\n  desc 'fix', \"\n      Maintain the default permissions for the system drive's root directory and\n  configure the Security Option \\\"Network access: Let Everyone permissions apply\n  to anonymous users\\\" to \\\"Disabled\\\" (WN19-SO-000240).\n\n      Default Permissions\n      C:\\\\\n      Type - \\\"Allow\\\" for all\n      Inherited from - \\\"None\\\" for all\n\n      Principal - Access - Applies to\n\n      SYSTEM - Full control - This folder, subfolders, and files\n      Administrators - Full control - This folder, subfolders, and files\n      Users - Read & execute - This folder, subfolders, and files\n      Users - Create folders/append data - This folder and subfolders\n      Users - Create files/write data - Subfolders only\n      CREATOR OWNER - Full Control - Subfolders and files only\"\n  impact 0.5\n  tag 'severity': nil\n  tag 'gtitle': 'SRG-OS-000312-GPOS-00122'\n  tag 'satisfies': %w(SRG-OS-000312-GPOS-00122 SRG-OS-000312-GPOS-00123\nSRG-OS-000312-GPOS-00124)\n  tag 'gid': 'V-93019'\n  tag 'rid': 'SV-103107r1_rule'\n  tag 'stig_id': 'WN19-00-000140'\n  tag 'fix_id': 'F-99265r1_fix'\n  tag 'cci': ['CCI-002165']\n  tag 'nist': ['AC-3 (4)', 'Rev_4']\n\n  expected_c_perm = input('c_perm')\n  describe.one do\n    describe registry_key('HKEY_LOCAL_MACHINE\\\\System\\\\CurrentControlSet\\\\Control\\\\Lsa') do\n      it { should have_property 'EveryoneIncludesAnonymous' }\n      its('EveryoneIncludesAnonymous') { should eq 0 }\n    end\n    c_perm = json(command: \"icacls 'C:\\\\' | ConvertTo-Json\").params.map(&:strip)[0..-3].map { |e| e.gsub('C:\\\\ ', '') }\n    describe 'C:\\\\ permissions are set correctly on folder structure' do\n      subject { c_perm.eql? expected_c_perm }\n      it { should eq true }\n    end\n  end\nend\n",
      "source_location": { "ref": "./controls/V-93019.rb", "line": 1 },
      "id": "V-93019"
    }
  ],
  "groups": [
    { "title": null, "controls": ["V-93019"], "id": "controls/V-93019.rb" }
  ],
  "sha256": "2421b04ea83f00f7d4e3f2925adac054ae11ea3c69ab933471fada47f1240031",
  "status_message": "",
  "status": "loaded",
  "generator": { "name": "inspec", "version": "5.18.14" }
}
