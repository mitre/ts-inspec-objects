{
  "addedControlIDs": [
    "V-244519",
    "V-244520",
    "V-244521",
    "V-244522",
    "V-244523",
    "V-244524",
    "V-244525",
    "V-244526",
    "V-244527",
    "V-244528",
    "V-244529",
    "V-244530",
    "V-244531",
    "V-244532",
    "V-244533",
    "V-244534",
    "V-244535",
    "V-244536",
    "V-244537",
    "V-244538",
    "V-244539",
    "V-244540",
    "V-244541",
    "V-244542",
    "V-244543",
    "V-244544",
    "V-244545",
    "V-244546",
    "V-244547",
    "V-244548",
    "V-244549",
    "V-244550",
    "V-244551",
    "V-244552",
    "V-244553",
    "V-244554",
    "V-245540"
  ],
  "removedControlIDs": [
    "V-230528"
  ],
  "changedControls": {
    "V-244519": {
      "tags": {
        "severity": "medium",
        "gid": "V-244519",
        "rid": "SV-244519r743806_rule",
        "stig_id": "RHEL-08-010049",
        "gtitle": "SRG-OS-000023-GPOS-00006",
        "fix_id": "F-47751r743805_fix",
        "satisfies": [
          "SRG-OS-000023-GPOS-00006",
          "SRG-OS-000228-GPOS-00088"
        ],
        "documentable": false
      },
      "id": "V-244519",
      "title": "RHEL 8 must display a banner before granting local or remote access to the system via a graphical user logon.",
      "desc": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance. System use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist. ",
      "impact": 0.5,
      "descs": {
        "check": "Verify RHEL 8 displays a banner before granting access to the operating system via a graphical user logon. Note: This requirement assumes the use of the RHEL 8 default graphical user interface, Gnome Shell. If the system does not have any graphical user interface installed, this requirement is Not Applicable. Check to see if the operating system displays a banner at the logon screen with the following command: $ sudo grep banner-message-enable /etc/dconf/db/local.d/* banner-message-enable=true If \"banner-message-enable\" is set to \"false\" or is missing, this is a finding.",
        "fix": "Configure the operating system to display a banner before granting access to the system. Note: If the system does not have a graphical user interface installed, this requirement is Not Applicable. Create a database to contain the system-wide graphical user logon settings (if it does not already exist) with the following command: $ sudo touch /etc/dconf/db/local.d/01-banner-message Add the following lines to the [org/gnome/login-screen] section of the \"/etc/dconf/db/local.d/01-banner-message\": [org/gnome/login-screen] banner-message-enable=true Run the following command to update the database: $ sudo dconf update"
      }
    },
    "V-244520": {
      "tags": {
        "severity": "medium",
        "gid": "V-244520",
        "rid": "SV-244520r743809_rule",
        "stig_id": "RHEL-08-010131",
        "gtitle": "SRG-OS-000073-GPOS-00041",
        "fix_id": "F-47752r743808_fix",
        "documentable": false
      },
      "id": "V-244520",
      "title": "The RHEL 8 system-auth file must be configured to use a sufficient number of hashing rounds.",
      "desc": "The system must use a strong hashing algorithm to store the password. The system must use a sufficient number of hashing rounds to ensure the required level of entropy. Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.",
      "impact": 0.5,
      "descs": {
        "check": "Check that a minimum number of hash rounds is configured by running the following command: $ sudo grep rounds /etc/pam.d/system-auth password sufficient pam_unix.so sha512 rounds=5000 If \"rounds\" has a value below \"5000\", or is commented out, this is a finding.",
        "fix": "Configure RHEL 8 to encrypt all stored passwords with a strong cryptographic hash. Edit/modify the following line in the \"etc/pam.d/system-auth\" file and set \"rounds\" to a value no lower than \"5000\": password sufficient pam_unix.so sha512 rounds=5000"
      }
    },
    "V-244521": {
      "tags": {
        "severity": "medium",
        "gid": "V-244521",
        "rid": "SV-244521r743812_rule",
        "stig_id": "RHEL-08-010141",
        "gtitle": "SRG-OS-000080-GPOS-00048",
        "fix_id": "F-47753r743811_fix",
        "documentable": false
      },
      "id": "V-244521",
      "title": "RHEL 8 operating systems booted with United Extensible Firmware Interface (UEFI) must require a unique superusers name upon booting into single-user mode and maintenance.",
      "desc": "If the system does not require valid authentication before it boots into single-user or maintenance mode, anyone who invokes single-user or maintenance mode is granted privileged access to all files on the system. GRUB 2 is the default boot loader for RHEL 8 and is designed to require a password to boot into single-user mode or make modifications to the boot menu.",
      "impact": 0.5,
      "descs": {
        "check": "For systems that use BIOS, this is Not Applicable. Verify that a unique name is set as the \"superusers\" account: $ sudo grep -iw \"superusers\" /boot/efi/EFI/redhat/grub.cfg set superusers=\"[someuniquestringhere]\" export superusers If \"superusers\" is not set to a unique name or is missing a name, this is a finding.",
        "fix": "Configure the system to have a unique name for the grub superusers account. Edit the /etc/grub.d/01_users file and add or modify the following lines: set superusers=\"[someuniquestringhere]\" export superusers password_pbkdf2 [someuniquestringhere] ${GRUB2_PASSWORD} Generate a new grub.cfg file with the following command: $ sudo grub2-mkconfig -o /boot/efi/EFI/redhat/grub.cfg"
      }
    },
    "V-244522": {
      "tags": {
        "severity": "medium",
        "gid": "V-244522",
        "rid": "SV-244522r743815_rule",
        "stig_id": "RHEL-08-010149",
        "gtitle": "SRG-OS-000080-GPOS-00048",
        "fix_id": "F-47754r743814_fix",
        "documentable": false
      },
      "id": "V-244522",
      "title": "RHEL 8 operating systems booted with a BIOS must require a unique superusers name upon booting into single-user and maintenance modes.",
      "desc": "If the system does not require valid authentication before it boots into single-user or maintenance mode, anyone who invokes single-user or maintenance mode is granted privileged access to all files on the system. GRUB 2 is the default boot loader for RHEL 8 and is designed to require a password to boot into single-user mode or make modifications to the boot menu.",
      "impact": 0.5,
      "descs": {
        "check": "For systems that use UEFI, this is Not Applicable. Verify that a unique name is set as the \"superusers\" account: $ sudo grep -iw \"superusers\" /boot/grub2/grub.cfg set superusers=\"[someuniquestringhere]\" export superusers If \"superusers\" is not set to a unique name or is missing a name, this is a finding.",
        "fix": "Configure the system to have a unique name for the grub superusers account. Edit the /etc/grub.d/01_users file and add or modify the following lines: set superusers=\"[someuniquestringhere]\" export superusers password_pbkdf2 [someuniquestringhere] ${GRUB2_PASSWORD} Generate a new grub.cfg file with the following command: $ sudo grub2-mkconfig -o /boot/grub2/grub.cfg"
      }
    },
    "V-244523": {
      "tags": {
        "severity": "medium",
        "gid": "V-244523",
        "rid": "SV-244523r743818_rule",
        "stig_id": "RHEL-08-010152",
        "gtitle": "SRG-OS-000080-GPOS-00048",
        "fix_id": "F-47755r743817_fix",
        "documentable": false
      },
      "id": "V-244523",
      "title": "RHEL 8 operating systems must require authentication upon booting into emergency mode.",
      "desc": "If the system does not require valid root authentication before it boots into emergency or rescue mode, anyone who invokes emergency or rescue mode is granted privileged access to all files on the system.",
      "impact": 0.5,
      "descs": {
        "check": "Check to see if the system requires authentication for emergency mode with the following command: $ sudo grep sulogin-shell /usr/lib/systemd/system/emergency.service ExecStart=-/usr/lib/systemd/systemd-sulogin-shell emergency If the \"ExecStart\" line is configured for anything other than \"/usr/lib/systemd/systemd-sulogin-shell emergency\", commented out, or missing, this is a finding.",
        "fix": "Configure the system to require authentication upon booting into emergency mode by adding the following line to the \"/usr/lib/systemd/system/emergency.service\" file. ExecStart=-/usr/lib/systemd/systemd-sulogin-shell emergency"
      }
    },
    "V-244524": {
      "tags": {
        "severity": "medium",
        "gid": "V-244524",
        "rid": "SV-244524r743821_rule",
        "stig_id": "RHEL-08-010159",
        "gtitle": "SRG-OS-000120-GPOS-00061",
        "fix_id": "F-47756r743820_fix",
        "documentable": false
      },
      "id": "V-244524",
      "title": "The RHEL 8 pam_unix.so module must be configured in the system-auth file to use a FIPS 140-2 approved cryptographic hashing algorithm for system authentication.",
      "desc": "Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised. RHEL 8 systems utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules. FIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements. This allows for Security Levels 1, 2, 3, or 4 for use on a general-purpose computing system.",
      "impact": 0.5,
      "descs": {
        "check": "Verify that pam_unix.so module is configured to use sha512. Check that pam_unix.so module is configured to use sha512 in /etc/pam.d/system-auth with the following command: $ sudo grep password /etc/pam.d/system-auth | grep pam_unix password sufficient pam_unix.so sha512 rounds=5000 If \"sha512\" is missing, or is commented out, this is a finding.",
        "fix": "Configure RHEL 8 to use a FIPS 140-2 approved cryptographic hashing algorithm for system authentication. Edit/modify the following line in the \"/etc/pam.d/system-auth\" file to include the sha512 option for pam_unix.so: password sufficient pam_unix.so sha512 rounds=5000"
      }
    },
    "V-244525": {
      "tags": {
        "severity": "medium",
        "gid": "V-244525",
        "rid": "SV-244525r743824_rule",
        "stig_id": "RHEL-08-010201",
        "gtitle": "SRG-OS-000163-GPOS-00072",
        "fix_id": "F-47757r743823_fix",
        "satisfies": [
          "SRG-OS-000163-GPOS-00072",
          "SRG-OS-000126-GPOS-00066",
          "SRG-OS-000279-GPOS-00109"
        ],
        "documentable": false
      },
      "id": "V-244525",
      "title": "The RHEL 8 SSH daemon must be configured with a timeout interval.",
      "desc": "Terminating an idle SSH session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle SSH session will also free up resources committed by the managed network element. Terminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level and de-allocating networking assignments at the application level if multiple application sessions are using a single operating system-level network connection. This does not mean that the operating system terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session. RHEL 8 utilizes /etc/ssh/sshd_config for configurations of OpenSSH. Within the sshd_config the product of the values of \"ClientAliveInterval\" and \"ClientAliveCountMax\" are used to establish the inactivity threshold. The \"ClientAliveInterval\" is a timeout interval in seconds after which if no data has been received from the client, sshd will send a message through the encrypted channel to request a response from the client. The \"ClientAliveCountMax\" is the number of client alive messages that may be sent without sshd receiving any messages back from the client. If this threshold is met, sshd will disconnect the client. For more information on these settings and others, refer to the sshd_config man pages. ",
      "impact": 0.5,
      "descs": {
        "check": "Verify all network connections associated with SSH traffic are automatically terminated at the end of the session or after 10 minutes of inactivity. Check that the \"ClientAliveInterval\" variable is set to a value of \"600\" or less by performing the following command: $ sudo grep -i clientalive /etc/ssh/sshd_config ClientAliveInterval 600 ClientAliveCountMax 0 If \"ClientAliveInterval\" does not exist, does not have a value of \"600\" or less in \"/etc/ssh/sshd_config\", or is commented out, this is a finding.",
        "fix": "Configure RHEL 8 to automatically terminate all network connections associated with SSH traffic at the end of a session or after 10 minutes of inactivity. Modify or append the following lines in the \"/etc/ssh/sshd_config\" file: ClientAliveInterval 600 In order for the changes to take effect, the SSH daemon must be restarted. $ sudo systemctl restart sshd.service"
      }
    },
    "V-244526": {
      "tags": {
        "severity": "medium",
        "gid": "V-244526",
        "rid": "SV-244526r743827_rule",
        "stig_id": "RHEL-08-010287",
        "gtitle": "SRG-OS-000250-GPOS-00093",
        "fix_id": "F-47758r743826_fix",
        "satisfies": [
          "SRG-OS-000250-GPOS-00093",
          "SRG-OS-000393-GPOS-00173",
          "SRG-OS-000394-GPOS-00174",
          "SRG-OS-000125-GPOS-00065"
        ],
        "documentable": false
      },
      "id": "V-244526",
      "title": "The RHEL 8 SSH daemon must be configured to use system-wide crypto policies.",
      "desc": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection. Remote access (e.g., RDP) is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. Cryptographic mechanisms used for protecting the integrity of information include, for example, signed hash functions using asymmetric cryptography enabling distribution of the public key to verify the hash information while maintaining the confidentiality of the secret key used to generate the hash. RHEL 8 incorporates system-wide crypto policies by default. The SSH configuration file has no effect on the ciphers, MACs, or algorithms unless specifically defined in the /etc/sysconfig/sshd file. The employed algorithms can be viewed in the /etc/crypto-policies/back-ends/ directory. ",
      "impact": 0.5,
      "descs": {
        "check": "Verify that system-wide crypto policies are in effect: $ sudo grep -i crypto_policy /etc/sysconfig/sshd # crypto_policy= If the \"crypto_policy\" is uncommented, this is a finding.",
        "fix": "Configure the RHEL 8 SSH daemon to use system-wide crypto policies by adding the following line to /etc/sysconfig/sshd: # crypto_policy= A reboot is required for the changes to take effect."
      }
    },
    "V-244527": {
      "tags": {
        "severity": "low",
        "gid": "V-244527",
        "rid": "SV-244527r743830_rule",
        "stig_id": "RHEL-08-010472",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "fix_id": "F-47759r743829_fix",
        "documentable": false
      },
      "id": "V-244527",
      "title": "RHEL 8 must have the packages required to use the hardware random number generator entropy gatherer service.",
      "desc": "The most important characteristic of a random number generator is its randomness, namely its ability to deliver random numbers that are impossible to predict. Entropy in computer security is associated with the unpredictability of a source of randomness. The random source with high entropy tends to achieve a uniform distribution of random values. Random number generators are one of the most important building blocks of cryptosystems. The rngd service feeds random data from hardware device to kernel random device. Quality (non-predictable) random number generation is important for several security functions (i.e., ciphers).",
      "impact": 0.3,
      "descs": {
        "check": "Check that RHEL 8 has the packages required to enabled the hardware random number generator entropy gatherer service with the following command: $ sudo yum list installed rng-tools rng-tools.x86_64 6.8-3.el8 @anaconda If the \"rng-tools\" package is not installed, this is a finding.",
        "fix": "Install the packages required to enabled the hardware random number generator entropy gatherer service with the following command: $ sudo yum install rng-tools"
      }
    },
    "V-244528": {
      "tags": {
        "severity": "medium",
        "gid": "V-244528",
        "rid": "SV-244528r743833_rule",
        "stig_id": "RHEL-08-010522",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "fix_id": "F-47760r743832_fix",
        "documentable": false
      },
      "id": "V-244528",
      "title": "The RHEL 8 SSH daemon must not allow GSSAPI authentication, except to fulfill documented and validated mission requirements.",
      "desc": "Configuring this setting for the SSH daemon provides additional assurance that remote logon via SSH will require a password, even in the event of misconfiguration elsewhere.",
      "impact": 0.5,
      "descs": {
        "check": "Verify the SSH daemon does not allow GSSAPI authentication with the following command: $ sudo grep -i GSSAPIAuthentication /etc/ssh/sshd_config GSSAPIAuthentication no If the value is returned as \"yes\", the returned line is commented out, no output is returned, or has not been documented with the ISSO, this is a finding.",
        "fix": "Configure the SSH daemon to not allow GSSAPI authentication. Add the following line in \"/etc/ssh/sshd_config\", or uncomment the line and set the value to \"no\": GSSAPIAuthentication no The SSH daemon must be restarted for the changes to take effect. To restart the SSH daemon, run the following command: $ sudo systemctl restart sshd.service"
      }
    },
    "V-244529": {
      "tags": {
        "severity": "medium",
        "gid": "V-244529",
        "rid": "SV-244529r743836_rule",
        "stig_id": "RHEL-08-010544",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "fix_id": "F-47761r743835_fix",
        "documentable": false
      },
      "id": "V-244529",
      "title": "RHEL 8 must use a separate file system for /var/tmp.",
      "desc": "The use of separate file systems for different paths can protect the system from failures resulting from a file system becoming full or failing.",
      "impact": 0.5,
      "descs": {
        "check": "Verify that a separate file system/partition has been created for \"/var/tmp\". Check that a file system/partition has been created for \"/var/tmp\" with the following command: $ sudo grep /var/tmp /etc/fstab UUID=c274f65f /var/tmp xfs noatime,nobarrier 1 2 If a separate entry for \"/var/tmp\" is not in use, this is a finding.",
        "fix": "Migrate the \"/var/tmp\" path onto a separate file system."
      }
    },
    "V-244530": {
      "tags": {
        "severity": "medium",
        "gid": "V-244530",
        "rid": "SV-244530r743839_rule",
        "stig_id": "RHEL-08-010572",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "fix_id": "F-47762r743838_fix",
        "documentable": false
      },
      "id": "V-244530",
      "title": "RHEL 8 must prevent files with the setuid and setgid bit set from being executed on the /boot/efi directory.",
      "desc": "The \"nosuid\" mount option causes the system not to execute \"setuid\" and \"setgid\" files with owner privileges. This option must be used for mounting any file system not containing approved \"setuid\" and \"setguid\" files. Executing files from untrusted file systems increases the opportunity for unprivileged users to attain unauthorized administrative access.",
      "impact": 0.5,
      "descs": {
        "check": "For systems that use BIOS, this is Not Applicable. Verify the /boot/efi directory is mounted with the \"nosuid\" option with the following command: $ sudo mount | grep '\\s/boot/efi\\s' /dev/sda1 on /boot/efi type xfs (rw,nosuid,relatime,seclabe,attr2,inode64,noquota) If the /boot/efi file system does not have the \"nosuid\" option set, this is a finding.",
        "fix": "Configure the \"/etc/fstab\" to use the \"nosuid\" option on the /boot/efi directory."
      }
    },
    "V-244531": {
      "tags": {
        "severity": "medium",
        "gid": "V-244531",
        "rid": "SV-244531r743842_rule",
        "stig_id": "RHEL-08-010731",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "fix_id": "F-47763r743841_fix",
        "documentable": false
      },
      "id": "V-244531",
      "title": "All RHEL 8 local interactive user home directory files must have mode 0750 or less permissive.",
      "desc": "Excessive permissions on local interactive user home directories may allow unauthorized access to user files by other users.",
      "impact": 0.5,
      "descs": {
        "check": "Verify all files and directories contained in a local interactive user home directory, excluding local initialization files, have a mode of \"0750\". Files that begin with a \".\" are excluded from this requirement. Note: The example will be for the user \"smithj\", who has a home directory of \"/home/smithj\". $ sudo ls -lLR /home/smithj -rwxr-x--- 1 smithj smithj 18 Mar 5 17:06 file1 -rwxr----- 1 smithj smithj 193 Mar 5 17:06 file2 -rw-r-x--- 1 smithj smithj 231 Mar 5 17:06 file3 If any files or directories are found with a mode more permissive than \"0750\", this is a finding.",
        "fix": "Set the mode on files and directories in the local interactive user home directory with the following command: Note: The example will be for the user smithj, who has a home directory of \"/home/smithj\" and is a member of the users group. $ sudo chmod 0750 /home/smithj/&lt;file or directory&gt;"
      }
    },
    "V-244532": {
      "tags": {
        "severity": "medium",
        "gid": "V-244532",
        "rid": "SV-244532r743845_rule",
        "stig_id": "RHEL-08-010741",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "fix_id": "F-47764r743844_fix",
        "documentable": false
      },
      "id": "V-244532",
      "title": "RHEL 8 must be configured so that all files and directories contained in local interactive user home directories are group-owned by a group of which the home directory owner is a member.",
      "desc": "If a local interactive user's files are group-owned by a group of which the user is not a member, unintended users may be able to access them.",
      "impact": 0.5,
      "descs": {
        "check": "Verify all files and directories in a local interactive user home directory are group-owned by a group that the user is a member. Check the group owner of all files and directories in a local interactive user's home directory with the following command: Note: The example will be for the user \"smithj\", who has a home directory of \"/home/smithj\". $ sudo ls -lLR /&lt;home directory&gt;/&lt;users home directory&gt;/ -rw-r--r-- 1 smithj smithj 18 Mar 5 17:06 file1 -rw-r--r-- 1 smithj smithj 193 Mar 5 17:06 file2 -rw-r--r-- 1 smithj sa 231 Mar 5 17:06 file3 If any files found with a group-owner different from the home directory user private group, check to see if the user is a member of that group with the following command: $ sudo grep smithj /etc/group sa:x:100:juan,shelley,bob,smithj smithj:x:521:smithj If any files or directories are group owned by a group that the directory owner is not a member of, this is a finding.",
        "fix": "Change the group of a local interactive user's files and directories to a group that the interactive user is a member. To change the group owner of a local interactive user's files and directories, use the following command: Note: The example will be for the user smithj, who has a home directory of \"/home/smithj\" and is a member of the users group. $ sudo chgrp smithj /home/smithj/&lt;file or directory&gt;"
      }
    },
    "V-244533": {
      "tags": {
        "severity": "medium",
        "gid": "V-244533",
        "rid": "SV-244533r743848_rule",
        "stig_id": "RHEL-08-020025",
        "gtitle": "SRG-OS-000021-GPOS-00005",
        "fix_id": "F-47765r743847_fix",
        "satisfies": [
          "SRG-OS-000021-GPOS-00005",
          "SRG-OS-000329-GPOS-00128"
        ],
        "documentable": false
      },
      "id": "V-244533",
      "title": "RHEL 8 must configure the use of the pam_faillock.so module in the /etc/pam.d/system-auth file.",
      "desc": "By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account. In RHEL 8.2 the \"/etc/security/faillock.conf\" file was incorporated to centralize the configuration of the pam_faillock.so module. Also introduced is a \"local_users_only\" option that will only track failed user authentication attempts for local users in /etc/passwd and ignore centralized (AD, IdM, LDAP, etc.) users to allow the centralized platform to solely manage user lockout. From \"faillock.conf\" man pages: Note that the default directory that \"pam_faillock\" uses is usually cleared on system boot so the access will be reenabled after system reboot. If that is undesirable a different tally directory must be set with the \"dir\" option. The preauth argument must be used when the module is called before the modules which ask for the user credentials such as the password. ",
      "impact": 0.5,
      "descs": {
        "check": "Note: This check applies to RHEL versions 8.2 or newer, if the system is RHEL version 8.0 or 8.1, this check is not applicable. Verify the pam_faillock.so module is present in the \"/etc/pam.d/system-auth\" file: $ sudo grep pam_faillock.so /etc/pam.d/system-auth auth required pam_faillock.so preauth auth required pam_faillock.so authfail account required pam_faillock.so If the pam_faillock.so module is not present in the \"/etc/pam.d/system-auth\" file with the \"preauth\" line listed before pam_unix.so, this is a finding.",
        "fix": "Configure the operating system to include the use of the pam_faillock.so module in the /etc/pam.d/system-auth file. Add/Modify the appropriate sections of the \"/etc/pam.d/system-auth\" file to match the following lines: Note: The \"preauth\" line must be listed before pam_unix.so. auth required pam_faillock.so preauth auth required pam_faillock.so authfail account required pam_faillock.so"
      }
    },
    "V-244534": {
      "tags": {
        "severity": "medium",
        "gid": "V-244534",
        "rid": "SV-244534r743851_rule",
        "stig_id": "RHEL-08-020026",
        "gtitle": "SRG-OS-000021-GPOS-00005",
        "fix_id": "F-47766r743850_fix",
        "satisfies": [
          "SRG-OS-000021-GPOS-00005",
          "SRG-OS-000329-GPOS-00128"
        ],
        "documentable": false
      },
      "id": "V-244534",
      "title": "RHEL 8 must configure the use of the pam_faillock.so module in the /etc/pam.d/password-auth file.",
      "desc": "By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account. In RHEL 8.2 the \"/etc/security/faillock.conf\" file was incorporated to centralize the configuration of the pam_faillock.so module. Also introduced is a \"local_users_only\" option that will only track failed user authentication attempts for local users in /etc/passwd and ignore centralized (AD, IdM, LDAP, etc.) users to allow the centralized platform to solely manage user lockout. From \"faillock.conf\" man pages: Note that the default directory that \"pam_faillock\" uses is usually cleared on system boot so the access will be reenabled after system reboot. If that is undesirable a different tally directory must be set with the \"dir\" option. The preauth argument must be used when the module is called before the modules which ask for the user credentials such as the password. ",
      "impact": 0.5,
      "descs": {
        "check": "Note: This check applies to RHEL versions 8.2 or newer, if the system is RHEL version 8.0 or 8.1, this check is not applicable. Verify the pam_faillock.so module is present in the \"/etc/pam.d/password-auth\" file: $ sudo grep pam_faillock.so /etc/pam.d/password-auth auth required pam_faillock.so preauth auth required pam_faillock.so authfail account required pam_faillock.so If the pam_faillock.so module is not present in the \"/etc/pam.d/password-auth\" file with the \"preauth\" line listed before pam_unix.so, this is a finding.",
        "fix": "Configure the operating system to include the use of the pam_faillock.so module in the /etc/pam.d/password-auth file. Add/Modify the appropriate sections of the \"/etc/pam.d/password-auth\" file to match the following lines: Note: The \"preauth\" line must be listed before pam_unix.so. auth required pam_faillock.so preauth auth required pam_faillock.so authfail account required pam_faillock.so"
      }
    },
    "V-244535": {
      "tags": {
        "severity": "medium",
        "gid": "V-244535",
        "rid": "SV-244535r743854_rule",
        "stig_id": "RHEL-08-020031",
        "gtitle": "SRG-OS-000029-GPOS-00010",
        "fix_id": "F-47767r743853_fix",
        "satisfies": [
          "SRG-OS-000029-GPOS-00010",
          "SRG-OS-000031-GPOS-00012",
          "SRG-OS-000480-GPOS-00227"
        ],
        "documentable": false
      },
      "id": "V-244535",
      "title": "RHEL 8 must initiate a session lock for graphical user interfaces when the screensaver is activated.",
      "desc": "A session time-out lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence. Rather than relying on the user to manually lock their operating system session prior to vacating the vicinity, operating systems need to be able to identify when a user's session has idled and take action to initiate the session lock. The session lock is implemented at the point where session activity can be determined and/or controlled. ",
      "impact": 0.5,
      "descs": {
        "check": "Verify the operating system initiates a session lock a for graphical user interfaces when the screensaver is activated with the following command: Note: This requirement assumes the use of the RHEL 8 default graphical user interface, Gnome Shell. If the system does not have any graphical user interface installed, this requirement is Not Applicable. $ sudo gsettings get org.gnome.desktop.screensaver lock-delay uint32 5 If the \"uint32\" setting is missing, or is not set to \"5\" or less, this is a finding.",
        "fix": "Configure the operating system to initiate a session lock for graphical user interfaces when a screensaver is activated. Create a database to contain the system-wide screensaver settings (if it does not already exist) with the following command: Note: The example below is using the database \"local\" for the system, so if the system is using another database in \"/etc/dconf/profile/user\", the file should be created under the appropriate subdirectory. $ sudo touch /etc/dconf/db/local.d/00-screensaver [org/gnome/desktop/screensaver] lock-delay=uint32 5 The \"uint32\" must be included along with the integer key values as shown. Update the system databases: $ sudo dconf update"
      }
    },
    "V-244536": {
      "tags": {
        "severity": "medium",
        "gid": "V-244536",
        "rid": "SV-244536r743857_rule",
        "stig_id": "RHEL-08-020032",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "fix_id": "F-47768r743856_fix",
        "documentable": false
      },
      "id": "V-244536",
      "title": "RHEL 8 must disable the user list at logon for graphical user interfaces.",
      "desc": "Leaving the user list enabled is a security risk since it allows anyone with physical access to the system to enumerate known user accounts without authenticated access to the system.",
      "impact": 0.5,
      "descs": {
        "check": "Verify the operating system disables the user logon list for graphical user interfaces with the following command: Note: This requirement assumes the use of the RHEL 8 default graphical user interface, Gnome Shell. If the system does not have any graphical user interface installed, this requirement is Not Applicable. $ sudo gsettings get org.gnome.login-screen disable-user-list true If the setting is \"false\", this is a finding.",
        "fix": "Configure the operating system to disable the user list at logon for graphical user interfaces. Create a database to contain the system-wide screensaver settings (if it does not already exist) with the following command: Note: The example below is using the database \"local\" for the system, so if the system is using another database in \"/etc/dconf/profile/user\", the file should be created under the appropriate subdirectory. $ sudo touch /etc/dconf/db/local.d/02-login-screen [org/gnome/login-screen] disable-user-list=true Update the system databases: $ sudo dconf update"
      }
    },
    "V-244537": {
      "tags": {
        "severity": "medium",
        "gid": "V-244537",
        "rid": "SV-244537r743860_rule",
        "stig_id": "RHEL-08-020039",
        "gtitle": "SRG-OS-000028-GPOS-00009",
        "fix_id": "F-47769r743859_fix",
        "satisfies": [
          "SRG-OS-000028-GPOS-00009",
          "SRG-OS-000030-GPOS-00011"
        ],
        "documentable": false
      },
      "id": "V-244537",
      "title": "RHEL 8 must have the tmux package installed.",
      "desc": "A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not want to log out because of the temporary nature of the absence. The session lock is implemented at the point where session activity can be determined. Rather than be forced to wait for a period of time to expire before the user session can be locked, RHEL 8 needs to provide users with the ability to manually invoke a session lock so users can secure their session if it is necessary to temporarily vacate the immediate physical vicinity. Tmux is a terminal multiplexer that enables a number of terminals to be created, accessed, and controlled from a single screen. Red Hat endorses tmux as the recommended session controlling package. ",
      "impact": 0.5,
      "descs": {
        "check": "Verify RHEL 8 has the \"tmux\" package installed, by running the following command: $ sudo yum list installed tmux tmux.x86.64 2.7-1.el8 @repository If \"tmux\" is not installed, this is a finding.",
        "fix": "Configure the operating system to enable a user to initiate a session lock via tmux. Install the \"tmux\" package, if it is not already installed, by running the following command: $ sudo yum install tmux"
      }
    },
    "V-244538": {
      "tags": {
        "severity": "medium",
        "gid": "V-244538",
        "rid": "SV-244538r743863_rule",
        "stig_id": "RHEL-08-020081",
        "gtitle": "SRG-OS-000029-GPOS-00010",
        "fix_id": "F-47770r743862_fix",
        "satisfies": [
          "SRG-OS-000029-GPOS-00010",
          "SRG-OS-000031-GPOS-00012",
          "SRG-OS-000480-GPOS-00227"
        ],
        "documentable": false
      },
      "id": "V-244538",
      "title": "RHEL 8 must prevent a user from overriding the session idle-delay setting for the graphical user interface.",
      "desc": "A session time-out lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence. Rather than relying on the user to manually lock their operating system session prior to vacating the vicinity, operating systems need to be able to identify when a user's session has idled and take action to initiate the session lock. The session lock is implemented at the point where session activity can be determined and/or controlled. Implementing session settings will have little value if a user is able to manipulate these settings from the defaults prescribed in the other requirements of this implementation guide. Locking these settings from non-privileged users is crucial to maintaining a protected baseline. ",
      "impact": 0.5,
      "descs": {
        "check": "Verify the operating system prevents a user from overriding settings for graphical user interfaces. Note: This requirement assumes the use of the RHEL 8 default graphical user interface, Gnome Shell. If the system does not have any graphical user interface installed, this requirement is Not Applicable. Determine which profile the system database is using with the following command: $ sudo grep system-db /etc/dconf/profile/user system-db:local Check that graphical settings are locked from non-privileged user modification with the following command: Note: The example below is using the database \"local\" for the system, so the path is \"/etc/dconf/db/local.d\". This path must be modified if a database other than \"local\" is being used. $ sudo grep -i idle /etc/dconf/db/local.d/locks/* /org/gnome/desktop/session/idle-delay If the command does not return at least the example result, this is a finding.",
        "fix": "Configure the operating system to prevent a user from overriding settings for graphical user interfaces. Create a database to contain the system-wide screensaver settings (if it does not already exist) with the following command: Note: The example below is using the database \"local\" for the system, so if the system is using another database in \"/etc/dconf/profile/user\", the file should be created under the appropriate subdirectory. $ sudo touch /etc/dconf/db/local.d/locks/session Add the following setting to prevent non-privileged users from modifying it: /org/gnome/desktop/session/idle-delay"
      }
    },
    "V-244539": {
      "tags": {
        "severity": "medium",
        "gid": "V-244539",
        "rid": "SV-244539r743866_rule",
        "stig_id": "RHEL-08-020082",
        "gtitle": "SRG-OS-000029-GPOS-00010",
        "fix_id": "F-47771r743865_fix",
        "satisfies": [
          "SRG-OS-000029-GPOS-00010",
          "SRG-OS-000031-GPOS-00012",
          "SRG-OS-000480-GPOS-00227"
        ],
        "documentable": false
      },
      "id": "V-244539",
      "title": "RHEL 8 must prevent a user from overriding the screensaver lock-enabled setting for the graphical user interface.",
      "desc": "A session time-out lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence. Rather than relying on the user to manually lock their operating system session prior to vacating the vicinity, operating systems need to be able to identify when a user's session has idled and take action to initiate the session lock. The session lock is implemented at the point where session activity can be determined and/or controlled. Implementing session settings will have little value if a user is able to manipulate these settings from the defaults prescribed in the other requirements of this implementation guide. Locking these settings from non-privileged users is crucial to maintaining a protected baseline. ",
      "impact": 0.5,
      "descs": {
        "check": "Verify the operating system prevents a user from overriding settings for graphical user interfaces. Note: This requirement assumes the use of the RHEL 8 default graphical user interface, Gnome Shell. If the system does not have any graphical user interface installed, this requirement is Not Applicable. Determine which profile the system database is using with the following command: $ sudo grep system-db /etc/dconf/profile/user system-db:local Check that graphical settings are locked from non-privileged user modification with the following command: Note: The example below is using the database \"local\" for the system, so the path is \"/etc/dconf/db/local.d\". This path must be modified if a database other than \"local\" is being used. $ sudo grep -i lock-enabled /etc/dconf/db/local.d/locks/* /org/gnome/desktop/screensaver/lock-enabled If the command does not return at least the example result, this is a finding.",
        "fix": "Configure the operating system to prevent a user from overriding settings for graphical user interfaces. Create a database to contain the system-wide screensaver settings (if it does not already exist) with the following command: Note: The example below is using the database \"local\" for the system, so if the system is using another database in \"/etc/dconf/profile/user\", the file should be created under the appropriate subdirectory. $ sudo touch /etc/dconf/db/local.d/locks/session Add the following setting to prevent non-privileged users from modifying it: /org/gnome/desktop/screensaver/lock-enabled"
      }
    },
    "V-244540": {
      "tags": {
        "severity": "high",
        "gid": "V-244540",
        "rid": "SV-244540r743869_rule",
        "stig_id": "RHEL-08-020331",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "fix_id": "F-47772r743868_fix",
        "documentable": false
      },
      "id": "V-244540",
      "title": "RHEL 8 must not allow blank or null passwords in the system-auth file.",
      "desc": "If an account has an empty password, anyone could log on and run commands with the privileges of that account. Accounts with empty passwords should never be used in operational environments.",
      "impact": 0.7,
      "descs": {
        "check": "To verify that null passwords cannot be used, run the following command: $ sudo grep -i nullok /etc/pam.d/system-auth If output is produced, this is a finding.",
        "fix": "Remove any instances of the \"nullok\" option in the \"/etc/pam.d/system-auth\" file to prevent logons with empty passwords. Note: Manual changes to the listed file may be overwritten by the \"authselect\" program."
      }
    },
    "V-244541": {
      "tags": {
        "severity": "high",
        "gid": "V-244541",
        "rid": "SV-244541r743872_rule",
        "stig_id": "RHEL-08-020332",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "fix_id": "F-47773r743871_fix",
        "documentable": false
      },
      "id": "V-244541",
      "title": "RHEL 8 must not allow blank or null passwords in the password-auth file.",
      "desc": "If an account has an empty password, anyone could log on and run commands with the privileges of that account. Accounts with empty passwords should never be used in operational environments.",
      "impact": 0.7,
      "descs": {
        "check": "To verify that null passwords cannot be used, run the following command: $ sudo grep -i nullok /etc/pam.d/password-auth If output is produced, this is a finding.",
        "fix": "Remove any instances of the \"nullok\" option in the \"/etc/pam.d/password-auth\" file to prevent logons with empty passwords. Note: Manual changes to the listed file may be overwritten by the \"authselect\" program."
      }
    },
    "V-244542": {
      "tags": {
        "severity": "medium",
        "gid": "V-244542",
        "rid": "SV-244542r743875_rule",
        "stig_id": "RHEL-08-030181",
        "gtitle": "SRG-OS-000062-GPOS-00031",
        "fix_id": "F-47774r743874_fix",
        "satisfies": [
          "SRG-OS-000062-GPOS-00031",
          "SRG-OS-000037-GPOS-00015",
          "SRG-OS-000038-GPOS-00016",
          "SRG-OS-000039-GPOS-00017",
          "SRG-OS-000040-GPOS-00018",
          "SRG-OS-000041-GPOS-00019",
          "SRG-OS-000042-GPOS-00021",
          "SRG-OS-000051-GPOS-00024",
          "SRG-OS-000054-GPOS-00025",
          "SRG-OS-000122-GPOS-00063",
          "SRG-OS-000254-GPOS-00095",
          "SRG-OS-000255-GPOS-00096",
          "SRG-OS-000337-GPOS-00129",
          "SRG-OS-000348-GPOS-00136",
          "SRG-OS-000349-GPOS-00137",
          "SRG-OS-000350-GPOS-00138",
          "SRG-OS-000351-GPOS-00139",
          "SRG-OS-000352-GPOS-00140",
          "SRG-OS-000353-GPOS-00141",
          "SRG-OS-000354-GPOS-00142",
          "SRG-OS-000358-GPOS-00145",
          "SRG-OS-000365-GPOS-00152",
          "SRG-OS-000392-GPOS-00172",
          "SRG-OS-000475-GPOS-00220"
        ],
        "documentable": false
      },
      "id": "V-244542",
      "title": "RHEL 8 audit records must contain information to establish what type of events occurred, the source of events, where events occurred, and the outcome of events.",
      "desc": "Without establishing what type of events occurred, the source of events, where events occurred, and the outcome of events, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack. Audit record content that may be necessary to satisfy this requirement includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked. Associating event types with detected events in RHEL 8 audit logs provides a means of investigating an attack, recognizing resource utilization or capacity thresholds, or identifying an improperly configured RHEL 8 system. ",
      "impact": 0.5,
      "descs": {
        "check": "Verify the audit service is configured to produce audit records with the following command: $ sudo systemctl status auditd.service. auditd.service - Security Auditing Service Loaded:loaded (/usr/lib/systemd/system/auditd.service; enabled; vendor preset: enabled) Active: active (running) since Tues 2020-12-11 12:56:56 EST; 4 weeks 0 days ago If the audit service is not \"active\" and \"running\", this is a finding.",
        "fix": "Configure the audit service to produce audit records containing the information needed to establish when (date and time) an event occurred with the following commands: $ sudo systemctl enable auditd.service $ sudo systemctl start auditd.service"
      }
    },
    "V-244543": {
      "tags": {
        "severity": "medium",
        "gid": "V-244543",
        "rid": "SV-244543r743878_rule",
        "stig_id": "RHEL-08-030731",
        "gtitle": "SRG-OS-000343-GPOS-00134",
        "fix_id": "F-47775r743877_fix",
        "documentable": false
      },
      "id": "V-244543",
      "title": "RHEL 8 must notify the System Administrator (SA) and Information System Security Officer (ISSO) (at a minimum) when allocated audit record storage volume 75 percent utilization.",
      "desc": "If security personnel are not notified immediately when storage volume reaches 75 percent utilization, they are unable to plan for audit record storage capacity expansion.",
      "impact": 0.5,
      "descs": {
        "check": "Verify RHEL 8 notifies the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity with the following command: $ sudo grep -w space_left_action /etc/audit/auditd.conf space_left_action = email If the value of the \"space_left_action\" is not set to \"email\", or if the line is commented out, ask the System Administrator to indicate how the system is providing real-time alerts to the SA and ISSO. If there is no evidence that real-time alerts are configured on the system, this is a finding.",
        "fix": "Configure the operating system to initiate an action to notify the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity by adding/modifying the following line in the /etc/audit/auditd.conf file. space_left_action = email Note: Option names and values in the auditd.conf file are case insensitive."
      }
    },
    "V-244544": {
      "tags": {
        "severity": "medium",
        "gid": "V-244544",
        "rid": "SV-244544r743881_rule",
        "stig_id": "RHEL-08-040101",
        "gtitle": "SRG-OS-000297-GPOS-00115",
        "fix_id": "F-47776r743880_fix",
        "documentable": false
      },
      "id": "V-244544",
      "title": "A firewall must be active on RHEL 8.",
      "desc": "\"Firewalld\" provides an easy and effective way to block/limit remote access to the system via ports, services, and protocols. Remote access services, such as those providing remote access to network devices and information systems, which lack automated control capabilities, increase risk and make remote user access management difficult at best. Remote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. RHEL 8 functionality (e.g., RDP) must be capable of taking enforcement action if the audit reveals unauthorized activity. Automated control of remote access sessions allows organizations to ensure ongoing compliance with remote access policies by enforcing connection rules of remote access applications on a variety of information system components (e.g., servers, workstations, notebook computers, smartphones, and tablets).",
      "impact": 0.5,
      "descs": {
        "check": "Verify that \"firewalld\" is active with the following commands: $ sudo systemctl is-active firewalld active If the \"firewalld\" package is not \"active\", ask the System Administrator if another firewall is installed. If no firewall is installed and active this is a finding.",
        "fix": "Configure \"firewalld\" to protect the operating system with the following command: $ sudo systemctl enable firewalld"
      }
    },
    "V-244545": {
      "tags": {
        "severity": "medium",
        "gid": "V-244545",
        "rid": "SV-244545r743884_rule",
        "stig_id": "RHEL-08-040136",
        "gtitle": "SRG-OS-000368-GPOS-00154",
        "fix_id": "F-47777r743883_fix",
        "satisfies": [
          "SRG-OS-000368-GPOS-00154",
          "SRG-OS-000370-GPOS-00155",
          "SRG-OS-000480-GPOS-00232"
        ],
        "documentable": false
      },
      "id": "V-244545",
      "title": "The RHEL 8 fapolicy module must be enabled.",
      "desc": "The organization must identify authorized software programs and permit execution of authorized software. The process used to identify software programs that are authorized to execute on organizational information systems is commonly referred to as whitelisting. Utilizing a whitelist provides a configuration management method for allowing the execution of only authorized software. Using only authorized software decreases risk by limiting the number of potential vulnerabilities. Verification of whitelisted software occurs prior to execution or at system startup. User home directories/folders may contain information of a sensitive nature. Non-privileged users should coordinate any sharing of information with an SA through shared resources. RHEL 8 ships with many optional packages. One such package is a file access policy daemon called \"fapolicyd\". \"fapolicyd\" is a userspace daemon that determines access rights to files based on attributes of the process and file. It can be used to either blacklist or whitelist processes or file access. Proceed with caution with enforcing the use of this daemon. Improper configuration may render the system non-functional. The \"fapolicyd\" API is not namespace aware and can cause issues when launching or running containers. ",
      "impact": 0.5,
      "descs": {
        "check": "Verify the RHEL 8 \"fapolicyd\" is enabled and running with the following command: $ sudo systemctl status fapolicyd.service fapolicyd.service - File Access Policy Daemon Loaded: loaded (/usr/lib/systemd/system/fapolicyd.service; enabled; vendor preset: disabled) Active: active (running) If fapolicyd is not enabled and running, this is a finding.",
        "fix": "Enable \"fapolicyd\" using the following command: $ sudo systemctl enable --now fapolicyd"
      }
    },
    "V-244546": {
      "tags": {
        "severity": "medium",
        "gid": "V-244546",
        "rid": "SV-244546r743887_rule",
        "stig_id": "RHEL-08-040137",
        "gtitle": "SRG-OS-000368-GPOS-00154",
        "fix_id": "F-47778r743886_fix",
        "satisfies": [
          "SRG-OS-000368-GPOS-00154",
          "SRG-OS-000370-GPOS-00155",
          "SRG-OS-000480-GPOS-00232"
        ],
        "documentable": false
      },
      "id": "V-244546",
      "title": "The RHEL 8 fapolicy module must be configured to employ a deny-all, permit-by-exception policy to allow the execution of authorized software programs.",
      "desc": "The organization must identify authorized software programs and permit execution of authorized software. The process used to identify software programs that are authorized to execute on organizational information systems is commonly referred to as whitelisting. Utilizing a whitelist provides a configuration management method for allowing the execution of only authorized software. Using only authorized software decreases risk by limiting the number of potential vulnerabilities. Verification of whitelisted software occurs prior to execution or at system startup. User home directories/folders may contain information of a sensitive nature. Non-privileged users should coordinate any sharing of information with an SA through shared resources. RHEL 8 ships with many optional packages. One such package is a file access policy daemon called \"fapolicyd\". \"fapolicyd\" is a userspace daemon that determines access rights to files based on attributes of the process and file. It can be used to either blacklist or whitelist processes or file access. Proceed with caution with enforcing the use of this daemon. Improper configuration may render the system non-functional. The \"fapolicyd\" API is not namespace aware and can cause issues when launching or running containers. ",
      "impact": 0.5,
      "descs": {
        "check": "Verify the RHEL 8 \"fapolicyd\" employs a deny-all, permit-by-exception policy. Check that \"fapolicyd\" is in enforcement mode with the following command: $ sudo grep permissive /etc/fapolicyd/fapolicyd.conf permissive = 0 Check that fapolicyd employs a deny-all policy on system mounts with the following commands: $ sudo tail /etc/fapolicyd/fapolicyd.rules allow exe=/usr/bin/python3.7 : ftype=text/x-python deny_audit perm=any pattern=ld_so : all deny perm=any all : all $ sudo cat /etc/fapolicyd/fapolicyd.mounts /dev/shm /run /sys/fs/cgroup / /home /boot /run/user/42 /run/user/1000 If fapolicyd is not running in enforcement mode on all system mounts with a deny-all, permit-by-exception policy, this is a finding.",
        "fix": "Configure RHEL 8 to employ a deny-all, permit-by-exception application whitelisting policy with \"fapolicyd\" using the following command: Note: Running this command requires a root shell # mount | egrep '^tmpfs| ext4| ext3| xfs' | awk '{ printf \"%s \", $3 }' &gt;&gt; /etc/fapolicyd/fapolicyd.mounts With the \"fapolicyd\" installed and enabled, configure the daemon to function in permissive mode until the whitelist is built correctly to avoid system lockout. Do this by editing the \"/etc/fapolicyd/fapolicyd.conf\" file with the following line: permissive = 1 Build the whitelist in the \"/etc/fapolicyd/fapolicyd.rules\" file ensuring the last rule is \"deny perm=any all : all\". Once it is determined the whitelist is built correctly, set the fapolicyd to enforcing mode by editing the \"permissive\" line in the /etc/fapolicyd/fapolicyd.conf file. permissive = 0"
      }
    },
    "V-244547": {
      "tags": {
        "severity": "medium",
        "gid": "V-244547",
        "rid": "SV-244547r743890_rule",
        "stig_id": "RHEL-08-040139",
        "gtitle": "SRG-OS-000378-GPOS-00163",
        "fix_id": "F-47779r743889_fix",
        "documentable": false
      },
      "id": "V-244547",
      "title": "RHEL 8 must have the USBGuard installed.",
      "desc": "Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Peripherals include, but are not limited to, such devices as flash drives, external storage, and printers. A new feature that RHEL 8 provides is the USBGuard software framework. The USBguard-daemon is the main component of the USBGuard software framework. It runs as a service in the background and enforces the USB device authorization policy for all USB devices. The policy is defined by a set of rules using a rule language described in the usbguard-rules.conf file. The policy and the authorization state of USB devices can be modified during runtime using the usbguard tool. The System Administrator (SA) must work with the site Information System Security Officer (ISSO) to determine a list of authorized peripherals and establish rules within the USBGuard software framework to allow only authorized devices.",
      "impact": 0.5,
      "descs": {
        "check": "Verify USBGuard is installed on the operating system with the following command: $ sudo yum list installed usbguard Installed Packages usbguard.x86_64 0.7.8-7.el8 @ol8_appstream If the USBGuard package is not installed, ask the SA to indicate how unauthorized peripherals are being blocked. If there is no evidence that unauthorized peripherals are being blocked before establishing a connection, this is a finding.",
        "fix": "Install the USBGuard package with the following command: $ sudo yum install usbguard.x86_64"
      }
    },
    "V-244548": {
      "tags": {
        "severity": "medium",
        "gid": "V-244548",
        "rid": "SV-244548r743893_rule",
        "stig_id": "RHEL-08-040141",
        "gtitle": "SRG-OS-000378-GPOS-00163",
        "fix_id": "F-47780r743892_fix",
        "documentable": false
      },
      "id": "V-244548",
      "title": "RHEL 8 must enable the USBGuard.",
      "desc": "Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Peripherals include, but are not limited to, such devices as flash drives, external storage, and printers. A new feature that RHEL 8 provides is the USBGuard software framework. The USBguard-daemon is the main component of the USBGuard software framework. It runs as a service in the background and enforces the USB device authorization policy for all USB devices. The policy is defined by a set of rules using a rule language described in the usbguard-rules.conf file. The policy and the authorization state of USB devices can be modified during runtime using the usbguard tool. The System Administrator (SA) must work with the site Information System Security Officer (ISSO) to determine a list of authorized peripherals and establish rules within the USBGuard software framework to allow only authorized devices.",
      "impact": 0.5,
      "descs": {
        "check": "Verify the operating system has enabled the use of the USBGuard with the following command: $ sudo systemctl status usbguard.service usbguard.service - USBGuard daemon Loaded: loaded (/usr/lib/systemd/system/usbguard.service; enabled; vendor preset: disabled) Active: active (running) If the usbguard.service is not enabled and active, ask the SA to indicate how unauthorized peripherals are being blocked. If there is no evidence that unauthorized peripherals are being blocked before establishing a connection, this is a finding.",
        "fix": "Configure the operating system to enable the blocking of unauthorized peripherals with the following commands: $ sudo systemctl enable usbguard.service $ sudo systemctl start usbguard.service Note: Enabling and starting usbguard without properly configuring it for an individual system will immediately prevent any access over a usb device such as a keyboard or mouse"
      }
    },
    "V-244549": {
      "tags": {
        "severity": "medium",
        "gid": "V-244549",
        "rid": "SV-244549r743896_rule",
        "stig_id": "RHEL-08-040159",
        "gtitle": "SRG-OS-000423-GPOS-00187",
        "fix_id": "F-47781r743895_fix",
        "satisfies": [
          "SRG-OS-000423-GPOS-00187",
          "SRG-OS-000424-GPOS-00188",
          "SRG-OS-000425-GPOS-00189",
          "SRG-OS-000426-GPOS-00190"
        ],
        "documentable": false
      },
      "id": "V-244549",
      "title": "All RHEL 8 networked systems must have SSH installed.",
      "desc": "Without protection of the transmitted information, confidentiality and integrity may be compromised because unprotected communications can be intercepted and either read or altered. This requirement applies to both internal and external networks and all types of information system components from which information can be transmitted (e.g., servers, mobile devices, notebook computers, printers, copiers, scanners, and facsimile machines). Communication paths outside the physical protection of a controlled boundary are exposed to the possibility of interception and modification. Protecting the confidentiality and integrity of organizational information can be accomplished by physical means (e.g., employing physical distribution systems) or by logical means (e.g., employing cryptographic techniques). If physical means of protection are employed, then logical means (cryptography) do not have to be employed, and vice versa. ",
      "impact": 0.5,
      "descs": {
        "check": "Verify SSH is installed with the following command: $ sudo yum list installed openssh-server openssh-server.x86_64 8.0p1-5.el8 @anaconda If the \"SSH server\" package is not installed, this is a finding.",
        "fix": "Install SSH packages onto the host with the following command: $ sudo yum install openssh-server.x86_64"
      }
    },
    "V-244550": {
      "tags": {
        "severity": "medium",
        "gid": "V-244550",
        "rid": "SV-244550r743899_rule",
        "stig_id": "RHEL-08-040209",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "fix_id": "F-47782r743898_fix",
        "documentable": false
      },
      "id": "V-244550",
      "title": "RHEL 8 must prevent IPv4 Internet Control Message Protocol (ICMP) redirect messages from being accepted.",
      "desc": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.",
      "impact": 0.5,
      "descs": {
        "check": "Verify RHEL 8 will not accept IPv4 ICMP redirect messages. Note: If IPv4 is disabled on the system, this requirement is Not Applicable. Check the value of the default \"accept_redirects\" variables with the following command: $ sudo sysctl net.ipv4.conf.default.accept_redirects net.ipv4.conf.default.accept_redirects = 0 If the returned line does not have a value of \"0\", a line is not returned, or the line is commented out, this is a finding.",
        "fix": "Configure RHEL 8 to prevent IPv4 ICMP redirect messages from being accepted with the following command: $ sudo sysctl -w net.ipv4.conf.default.accept_redirects=0 If \"0\" is not the system's default value then add or update the following line in the appropriate file under \"/etc/sysctl.d\": net.ipv4.conf.default.accept_redirects=0"
      }
    },
    "V-244551": {
      "tags": {
        "severity": "medium",
        "gid": "V-244551",
        "rid": "SV-244551r743902_rule",
        "stig_id": "RHEL-08-040239",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "fix_id": "F-47783r743901_fix",
        "documentable": false
      },
      "id": "V-244551",
      "title": "RHEL 8 must not forward IPv4 source-routed packets.",
      "desc": "Source-routed packets allow the source of the packet to suggest that routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures. This requirement applies only to the forwarding of source-routed traffic, such as when forwarding is enabled and the system is functioning as a router.",
      "impact": 0.5,
      "descs": {
        "check": "Verify RHEL 8 does not accept IPv4 source-routed packets. Note: If IPv4 is disabled on the system, this requirement is Not Applicable. Check the value of the accept source route variable with the following command: $ sudo sysctl net.ipv4.conf.all.accept_source_route net.ipv4.conf.all.accept_source_route = 0 If the returned line does not have a value of \"0\", a line is not returned, or the line is commented out, this is a finding.",
        "fix": "Configure RHEL 8 to not forward IPv4 source-routed packets with the following command: $ sudo sysctl -w net.ipv4.conf.all.accept_source_route=0 If \"0\" is not the system's all value then add or update the following line in the appropriate file under \"/etc/sysctl.d\": net.ipv4.conf.all.accept_source_route=0"
      }
    },
    "V-244552": {
      "tags": {
        "severity": "medium",
        "gid": "V-244552",
        "rid": "SV-244552r743905_rule",
        "stig_id": "RHEL-08-040249",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "fix_id": "F-47784r743904_fix",
        "documentable": false
      },
      "id": "V-244552",
      "title": "RHEL 8 must not forward IPv4 source-routed packets by default.",
      "desc": "Source-routed packets allow the source of the packet to suggest that routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures. This requirement applies only to the forwarding of source-routed traffic, such as when forwarding is enabled and the system is functioning as a router.",
      "impact": 0.5,
      "descs": {
        "check": "Verify RHEL 8 does not accept IPv4 source-routed packets by default. Note: If IPv4 is disabled on the system, this requirement is Not Applicable. Check the value of the accept source route variable with the following command: $ sudo sysctl net.ipv4.conf.default.accept_source_route net.ipv4.conf.default.accept_source_route = 0 If the returned line does not have a value of \"0\", a line is not returned, or the line is commented out, this is a finding.",
        "fix": "Configure RHEL 8 to not forward IPv4 source-routed packets by default with the following command: $ sudo sysctl -w net.ipv4.conf.default.accept_source_route=0 If \"0\" is not the system's default value then add or update the following line in the appropriate file under \"/etc/sysctl.d\": net.ipv4.conf.default.accept_source_route=0"
      }
    },
    "V-244553": {
      "tags": {
        "severity": "medium",
        "gid": "V-244553",
        "rid": "SV-244553r743908_rule",
        "stig_id": "RHEL-08-040279",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "fix_id": "F-47785r743907_fix",
        "documentable": false
      },
      "id": "V-244553",
      "title": "RHEL 8 must ignore IPv4 Internet Control Message Protocol (ICMP) redirect messages.",
      "desc": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.",
      "impact": 0.5,
      "descs": {
        "check": "Verify RHEL 8 ignores IPv4 ICMP redirect messages. Note: If IPv4 is disabled on the system, this requirement is Not Applicable. Check the value of the \"accept_redirects\" variables with the following command: $ sudo sysctl net.ipv4.conf.all.accept_redirects net.ipv4.conf.all.accept_redirects = 0 If the returned line does not have a value of \"0\", a line is not returned, or the line is commented out, this is a finding.",
        "fix": "Configure RHEL 8 to ignore IPv4 ICMP redirect messages with the following command: $ sudo sysctl -w net.ipv4.conf.all.accept_redirects=0 If \"0\" is not the system's default value then add or update the following line in the appropriate file under \"/etc/sysctl.d\": net.ipv4.conf.all.accept_redirects = 0"
      }
    },
    "V-244554": {
      "tags": {
        "severity": "medium",
        "gid": "V-244554",
        "rid": "SV-244554r743911_rule",
        "stig_id": "RHEL-08-040286",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "fix_id": "F-47786r743910_fix",
        "documentable": false
      },
      "id": "V-244554",
      "title": "RHEL 8 must enable hardening for the Berkeley Packet Filter Just-in-time compiler.",
      "desc": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors. Enabling hardening for the Berkeley Packet Filter (BPF) Just-in-time (JIT) compiler aids in mitigating JIT spraying attacks. Setting the value to \"2\" enables JIT hardening for all users.",
      "impact": 0.5,
      "descs": {
        "check": "Verify RHEL 8 enables hardening for the BPF JIT with the following commands: $ sudo sysctl net.core.bpf_jit_harden net.core.bpf_jit_harden = 2 If the returned line does not have a value of \"2\", or a line is not returned, this is a finding.",
        "fix": "Configure RHEL 8 to enable hardening for the BPF JIT compiler by adding the following line to a file in the \"/etc/sysctl.d\" directory: net.core.bpf_jit_harden = 2 The system configuration files need to be reloaded for the changes to take effect. To reload the contents of the files, run the following command: $ sudo sysctl --system"
      }
    },
    "V-245540": {
      "tags": {
        "severity": "medium",
        "gid": "V-245540",
        "rid": "SV-245540r754730_rule",
        "stig_id": "RHEL-08-010001",
        "gtitle": "SRG-OS-000191-GPOS-00080",
        "fix_id": "F-48770r754729_fix",
        "documentable": false
      },
      "id": "V-245540",
      "title": "The RHEL 8 operating system must implement the Endpoint Security for Linux Threat Prevention tool.",
      "desc": "Adding endpoint security tools can provide the capability to automatically take actions in response to malicious behavior, which can provide additional agility in reacting to network threats. These tools also often include a reporting capability to provide network awareness of the system, which may not otherwise exist in an organization's systems management regime.",
      "impact": 0.5,
      "descs": {
        "check": "Per OPORD 16-0080, the preferred endpoint security tool is McAfee Endpoint Security for Linux (ENSL) in conjunction with SELinux. Procedure: Check that the following package has been installed: $ sudo rpm -qa | grep -i mcafeetp If the \"mcafeetp\" package is not installed, this is a finding. Verify that the daemon is running: $ sudo ps -ef | grep -i mfetpd If the daemon is not running, this is a finding.",
        "fix": "Install and enable the latest McAfee ENSLTP package."
      }
    },
    "V-230221": {
      "tags": {
        "rid": "SV-230221r743913_rule"
      },
      "desc": "An operating system release is considered \"supported\" if the vendor continues to provide security patches for the product. With an unsupported release, it will not be possible to resolve security issues discovered in the system software. Red Hat offers the Extended Update Support (EUS) ad-on to a Red Hat Enterprise Linux subscription, for a fee, for those customers who wish to standardize on a specific minor release for an extended period. The RHEL 8 minor releases eligible for EUS are 8.1, 8.2, 8.4, 8.6, and 8.8. Each RHEL 8 EUS stream is available for 24 months from the availability of the minor release. RHEL 8.10 will be the final minor release overall. For more details on the Red Hat Enterprise Linux Life Cycle visit https://access.redhat.com/support/policy/updates/errata.",
      "descs": {
        "check": "Verify the version of the operating system is vendor supported. Check the version of the operating system with the following command: $ sudo cat /etc/redhat-release Red Hat Enterprise Linux Server release 8.4 (Ootpa) Current End of Extended Update Support for RHEL 8.1 is 30 November 2021. Current End of Extended Update Support for RHEL 8.2 is 30 April 2022. Current End of Extended Update Support for RHEL 8.4 is 30 April 2023. Current End of Maintenance Support for RHEL 8.5 is 30 April 2022. Current End of Extended Update Support for RHEL 8.6 is 30 April 2024. Current End of Maintenance Support for RHEL 8.7 is 30 April 2023. Current End of Extended Update Support for RHEL 8.8 is 30 April 2025. Current End of Maintenance Support for RHEL 8.9 is 30 April 2024. Current End of Maintenance Support for RHEL 8.10 is 31 May 2029. If the release is not supported by the vendor, this is a finding."
      }
    },
    "V-230226": {
      "tags": {
        "rid": "SV-230226r743916_rule",
        "fix_id": "F-32870r743915_fix"
      },
      "descs": {
        "check": "Verify RHEL 8 displays the Standard Mandatory DoD Notice and Consent Banner before granting access to the operating system via a graphical user logon. Note: This requirement assumes the use of the RHEL 8 default graphical user interface, Gnome Shell. If the system does not have any graphical user interface installed, this requirement is Not Applicable. Check that the operating system displays the exact Standard Mandatory DoD Notice and Consent Banner text with the command: $ sudo grep banner-message-text /etc/dconf/db/local.d/* banner-message-text= 'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions: -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations. -At any time, the USG may inspect and seize data stored on this IS. -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose. -This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details. ' Note: The \" \" characters are for formatting only. They will not be displayed on the graphical interface. If the banner does not match the Standard Mandatory DoD Notice and Consent Banner exactly, this is a finding.",
        "fix": "Configure the operating system to display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system. Note: If the system does not have a graphical user interface installed, this requirement is Not Applicable. Add the following lines to the [org/gnome/login-screen] section of the \"/etc/dconf/db/local.d/01-banner-message\": banner-message-text='You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions: -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations. -At any time, the USG may inspect and seize data stored on this IS. -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose. -This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details. ' Note: The \" \" characters are for formatting only. They will not be displayed on the graphical interface. Run the following command to update the database: $ sudo dconf update"
      }
    },
    "V-230233": {
      "tags": {
        "rid": "SV-230233r743919_rule",
        "fix_id": "F-32877r743918_fix"
      },
      "title": "The RHEL 8 password-auth file must be configured to use a sufficient number of hashing rounds.",
      "descs": {
        "check": "Check that a minimum number of hash rounds is configured by running the following command: $ sudo grep rounds /etc/pam.d/password-auth password sufficient pam_unix.so sha512 rounds=5000 If \"rounds\" has a value below \"5000\", or is commented out, this is a finding.",
        "fix": "Configure RHEL 8 to encrypt all stored passwords with a strong cryptographic hash. Edit/modify the following line in the \"/etc/pam.d/password-auth\" file and set \"rounds\" to a value no lower than \"5000\": password sufficient pam_unix.so sha512 rounds=5000"
      }
    },
    "V-230234": {
      "tags": {
        "rid": "SV-230234r743922_rule",
        "fix_id": "F-32878r743921_fix"
      },
      "title": "RHEL 8 operating systems booted with United Extensible Firmware Interface (UEFI) must require authentication upon booting into single-user mode and maintenance.",
      "descs": {
        "check": "For systems that use BIOS, this is Not Applicable. Check to see if an encrypted grub superusers password is set. On systems that use UEFI, use the following command: $ sudo grep -iw grub2_password /boot/efi/EFI/redhat/user.cfg GRUB2_PASSWORD=grub.pbkdf2.sha512.[password_hash] If the grub superusers password does not begin with \"grub.pbkdf2.sha512\", this is a finding.",
        "fix": "Configure the system to require a grub bootloader password for the grub superusers account with the grub2-setpassword command, which creates/overwrites the /boot/efi/EFI/redhat/user.cfg file. Generate an encrypted grub2 password for the grub superusers account with the following command: $ sudo grub2-setpassword Enter password: Confirm password:"
      }
    },
    "V-230235": {
      "tags": {
        "rid": "SV-230235r743925_rule",
        "fix_id": "F-32879r743924_fix"
      },
      "descs": {
        "check": "For systems that use UEFI, this is Not Applicable. Check to see if an encrypted grub superusers password is set. On systems that use a BIOS, use the following command: $ sudo grep -iw grub2_password /boot/grub2/user.cfg GRUB2_PASSWORD=grub.pbkdf2.sha512.[password_hash] If the grub superusers password does not begin with \"grub.pbkdf2.sha512\", this is a finding.",
        "fix": "Configure the system to require a grub bootloader password for the grub superusers account with the grub2-setpassword command, which creates/overwrites the /boot/grub2/user.cfg file. Generate an encrypted grub2 password for the grub superusers account with the following command: $ sudo grub2-setpassword Enter password: Confirm password:"
      }
    },
    "V-230236": {
      "tags": {
        "rid": "SV-230236r743928_rule",
        "fix_id": "F-32880r743927_fix"
      },
      "title": "RHEL 8 operating systems must require authentication upon booting into rescue mode.",
      "descs": {
        "check": "Check to see if the system requires authentication for rescue mode with the following command: $ sudo grep sulogin-shell /usr/lib/systemd/system/rescue.service ExecStart=-/usr/lib/systemd/systemd-sulogin-shell rescue If the \"ExecStart\" line is configured for anything other than \"/usr/lib/systemd/systemd-sulogin-shell rescue\", commented out, or missing, this is a finding.",
        "fix": "Configure the system to require authentication upon booting into rescue mode by adding the following line to the \"/usr/lib/systemd/system/rescue.service\" file. ExecStart=-/usr/lib/systemd/systemd-sulogin-shell rescue"
      }
    },
    "V-230237": {
      "tags": {
        "rid": "SV-230237r743931_rule",
        "fix_id": "F-32881r743930_fix"
      },
      "title": "The RHEL 8 pam_unix.so module must be configured in the password-auth file to use a FIPS 140-2 approved cryptographic hashing algorithm for system authentication.",
      "descs": {
        "check": "Verify that the pam_unix.so module is configured to use sha512. Check that the pam_unix.so module is configured to use sha512 in /etc/pam.d/password-auth with the following command: $ sudo grep password /etc/pam.d/password-auth | grep pam_unix password sufficient pam_unix.so sha512 rounds=5000 If \"sha512\" is missing, or is commented out, this is a finding.",
        "fix": "Configure RHEL 8 to use a FIPS 140-2 approved cryptographic hashing algorithm for system authentication. Edit/modify the following line in the \"/etc/pam.d/password-auth\" file to include the sha512 option for pam_unix.so: password sufficient pam_unix.so sha512 rounds=5000"
      }
    },
    "V-230244": {
      "tags": {
        "rid": "SV-230244r743934_rule",
        "fix_id": "F-32888r743933_fix"
      },
      "desc": "Terminating an idle SSH session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle SSH session will also free up resources committed by the managed network element. Terminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level and de-allocating networking assignments at the application level if multiple application sessions are using a single operating system-level network connection. This does not mean that the operating system terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session. RHEL 8 utilizes /etc/ssh/sshd_config for configurations of OpenSSH. Within the sshd_config the product of the values of \"ClientAliveInterval\" and \"ClientAliveCountMax\" are used to establish the inactivity threshold. The \"ClientAliveInterval\" is a timeout interval in seconds after which if no data has been received from the client, sshd will send a message through the encrypted channel to request a response from the client. The \"ClientAliveCountMax\" is the number of client alive messages that may be sent without sshd receiving any messages back from the client. If this threshold is met, sshd will disconnect the client. For more information on these settings and others, refer to the sshd_config man pages. ",
      "descs": {
        "check": "Verify all network connections associated with SSH traffic are automatically terminated at the end of the session or after 10 minutes of inactivity. Check that the \"ClientAliveCountMax\" is set to \"0\" by performing the following command: $ sudo grep -i clientalive /etc/ssh/sshd_config ClientAliveInterval 600 ClientAliveCountMax 0 If \"ClientAliveCountMax\" do not exist, is not set to a value of \"0\" in \"/etc/ssh/sshd_config\", or is commented out, this is a finding.",
        "fix": "Configure RHEL 8 to automatically terminate all network connections associated with SSH traffic at the end of a session or after 10 minutes of inactivity. Modify or append the following lines in the \"/etc/ssh/sshd_config\" file: ClientAliveCountMax 0 In order for the changes to take effect, the SSH daemon must be restarted. $ sudo systemctl restart sshd.service"
      }
    },
    "V-230251": {
      "tags": {
        "rid": "SV-230251r743937_rule",
        "fix_id": "F-32895r743936_fix"
      },
      "title": "The RHEL 8 SSH server must be configured to use only Message Authentication Codes (MACs) employing FIPS 140-2 validated cryptographic hash algorithms.",
      "desc": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection. Remote access (e.g., RDP) is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. Cryptographic mechanisms used for protecting the integrity of information include, for example, signed hash functions using asymmetric cryptography enabling distribution of the public key to verify the hash information while maintaining the confidentiality of the secret key used to generate the hash. RHEL 8 incorporates system-wide crypto policies by default. The SSH configuration file has no effect on the ciphers, MACs, or algorithms unless specifically defined in the /etc/sysconfig/sshd file. The employed algorithms can be viewed in the /etc/crypto-policies/back-ends/opensshserver.config file. The system will attempt to use the first hash presented by the client that matches the server list. Listing the values \"strongest to weakest\" is a method to ensure the use of the strongest hash available to secure the SSH connection. ",
      "descs": {
        "check": "Verify the SSH server is configured to use only MACs employing FIPS 140-2-approved algorithms with the following command: $ sudo grep -i macs /etc/crypto-policies/back-ends/opensshserver.config -oMACS=hmac-sha2-512,hmac-sha2-256 If the MACs entries in the \"opensshserver.config\" file have any hashes other than \"hmac-sha2-512\" and \"hmac-sha2-256\", the order differs from the example above, they are missing, or commented out, this is a finding.",
        "fix": "Configure the RHEL 8 SSH server to use only MACs employing FIPS 140-2-approved algorithms by updating the \"/etc/crypto-policies/back-ends/opensshserver.config\" file with the following line: -oMACS=hmac-sha2-512,hmac-sha2-256 A reboot is required for the changes to take effect."
      }
    },
    "V-230252": {
      "tags": {
        "rid": "SV-230252r743940_rule",
        "fix_id": "F-32896r743939_fix"
      },
      "title": "The RHEL 8 operating system must implement DoD-approved encryption to protect the confidentiality of SSH server connections.",
      "desc": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection. Remote access (e.g., RDP) is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. Cryptographic mechanisms used for protecting the integrity of information include, for example, signed hash functions using asymmetric cryptography enabling distribution of the public key to verify the hash information while maintaining the confidentiality of the secret key used to generate the hash. RHEL 8 incorporates system-wide crypto policies by default. The SSH configuration file has no effect on the ciphers, MACs, or algorithms unless specifically defined in the /etc/sysconfig/sshd file. The employed algorithms can be viewed in the /etc/crypto-policies/back-ends/opensshserver.config file. The system will attempt to use the first hash presented by the client that matches the server list. Listing the values \"strongest to weakest\" is a method to ensure the use of the strongest hash available to secure the SSH connection. ",
      "descs": {
        "check": "Verify the SSH server is configured to use only ciphers employing FIPS 140-2-approved algorithms with the following command: $ sudo grep -i ciphers /etc/crypto-policies/back-ends/opensshserver.config CRYPTO_POLICY='-oCiphers=aes256-ctr,aes192-ctr,aes128-ctr' If the cipher entries in the \"opensshserver.config\" file have any ciphers other than \"aes256-ctr,aes192-ctr,aes128-ctr\", the order differs from the example above, they are missing, or commented out, this is a finding.",
        "fix": "Configure the RHEL 8 SSH server to use only ciphers employing FIPS 140-2-approved algorithms by updating the \"/etc/crypto-policies/back-ends/opensshserver.config\" file with the following line: -oCiphers=aes256-ctr,aes192-ctr,aes128-ctr A reboot is required for the changes to take effect."
      }
    },
    "V-230273": {
      "tags": {
        "rid": "SV-230273r743943_rule",
        "fix_id": "F-32917r743942_fix"
      },
      "descs": {
        "check": "Verify the operating system has the packages required for multifactor authentication installed with the following commands: $ sudo yum list installed openssl-pkcs11 openssl-pkcs11.x86_64 0.4.8-2.el8 @anaconda If the \"openssl-pkcs11\" package is not installed, ask the administrator to indicate what type of multifactor authentication is being utilized and what packages are installed to support it. If there is no evidence of multifactor authentication being used, this is a finding.",
        "fix": "Configure the operating system to implement multifactor authentication by installing the required package with the following command: $ sudo yum install openssl-pkcs11"
      }
    },
    "V-230274": {
      "tags": {
        "rid": "SV-230274r743945_rule"
      },
      "descs": {
        "check": "Verify the operating system implements certificate status checking for multifactor authentication. Check to see if Online Certificate Status Protocol (OCSP) is enabled and using the proper digest value on the system with the following command: $ sudo grep certificate_verification /etc/sssd/sssd.conf /etc/sssd/conf.d/*.conf | grep -v \"^#\" certificate_verification = ocsp_dgst=sha1 If the certificate_verification line is missing from the [sssd] section, or is missing \"ocsp_dgst=sha1\", ask the administrator to indicate what type of multifactor authentication is being utilized and how the system implements certificate status checking. If there is no evidence of certificate status checking being used, this is a finding."
      }
    },
    "V-230278": {
      "tags": {
        "rid": "SV-230278r743948_rule",
        "fix_id": "F-32922r743947_fix"
      },
      "desc": "Syscalls are special routines in the Linux kernel, which userspace applications ask to do privileged tasks. Invoking a system call is an expensive operation because the processor must interrupt the currently executing task and switch context to kernel mode and then back to userspace after the system call completes. Virtual Syscalls map into user space a page that contains some variables and the implementation of some system calls. This allows the system calls to be executed in userspace to alleviate the context switching expense. Virtual Syscalls provide an opportunity of attack for a user who has control of the return instruction pointer. Disabling vsyscalls help to prevent return oriented programming (ROP) attacks via buffer overflows and overruns. If the system intends to run containers based on RHEL 6 components, then virtual syscalls will need enabled so the components function properly. ",
      "descs": {
        "check": "Verify that GRUB 2 is configured to disable vsyscalls with the following commands: Check that the current GRUB 2 configuration disables vsyscalls: $ sudo grub2-editenv - list | grep vsyscall kernelopts=root=/dev/mapper/rhel-root ro crashkernel=auto resume=/dev/mapper/rhel-swap rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap rhgb quiet fips=1 page_poison=1 vsyscall=none audit=1 audit_backlog_limit=8192 boot=UUID=8d171156-cd61-421c-ba41-1c021ac29e82 If \"vsyscall\" is not set to \"none\" or is missing, this is a finding. Check that vsyscalls are disabled by default to persist in kernel updates: $ sudo grep vsyscall /etc/default/grub GRUB_CMDLINE_LINUX=\"vsyscall=none\" If \"vsyscall\" is not set to \"none\", is missing or commented out and is not documented with the Information System Security Officer (ISSO) as an operational requirement, this is a finding.",
        "fix": "Document the use of vsyscalls with the ISSO as an operational requirement or disable them with the following command: $ sudo grubby --update-kernel=ALL --args=\"vsyscall=none\" Add or modify the following line in \"/etc/default/grub\" to ensure the configuration survives kernel updates: GRUB_CMDLINE_LINUX=\"vsyscall=none\""
      }
    },
    "V-230287": {
      "tags": {
        "rid": "SV-230287r743951_rule",
        "fix_id": "F-32931r743950_fix"
      },
      "title": "The RHEL 8 SSH private host key files must have mode 0600 or less permissive.",
      "descs": {
        "check": "Verify the SSH private host key files have mode \"0600\" or less permissive with the following command: $ sudo ls -l /etc/ssh/ssh_host*key -rw------- 1 root ssh_keys 668 Nov 28 06:43 ssh_host_dsa_key -rw------- 1 root ssh_keys 582 Nov 28 06:43 ssh_host_key -rw------- 1 root ssh_keys 887 Nov 28 06:43 ssh_host_rsa_key If any private host key file has a mode more permissive than \"0600\", this is a finding.",
        "fix": "Configure the mode of SSH private host key files under \"/etc/ssh\" to \"0600\" with the following command: $ sudo chmod 0600 /etc/ssh/ssh_host*key The SSH daemon must be restarted for the changes to take effect. To restart the SSH daemon, run the following command: $ sudo systemctl restart sshd.service"
      }
    },
    "V-230289": {
      "tags": {
        "rid": "SV-230289r743954_rule",
        "fix_id": "F-32933r743953_fix"
      },
      "descs": {
        "check": "Verify the SSH daemon performs compression after a user successfully authenticates with the following command: $ sudo grep -i compression /etc/ssh/sshd_config Compression delayed If the \"Compression\" keyword is set to \"yes\", is missing, or the returned line is commented out, this is a finding.",
        "fix": "Uncomment the \"Compression\" keyword in \"/etc/ssh/sshd_config\" (this file may be named differently or be in a different location if using a version of SSH that is provided by a third-party vendor) on the system and set the value to \"delayed\" or \"no\": Compression no The SSH service must be restarted for changes to take effect."
      }
    },
    "V-230291": {
      "tags": {
        "rid": "SV-230291r743957_rule",
        "fix_id": "F-32935r743956_fix"
      },
      "title": "The RHEL 8 SSH daemon must not allow Kerberos authentication, except to fulfill documented and validated mission requirements.",
      "descs": {
        "check": "Verify the SSH daemon does not allow Kerberos authentication with the following command: $ sudo grep -i KerberosAuthentication /etc/ssh/sshd_config KerberosAuthentication no If the value is returned as \"yes\", the returned line is commented out, no output is returned, or has not been documented with the ISSO, this is a finding.",
        "fix": "Configure the SSH daemon to not allow Kerberos authentication. Add the following line in \"/etc/ssh/sshd_config\", or uncomment the line and set the value to \"no\": KerberosAuthentication no The SSH daemon must be restarted for the changes to take effect. To restart the SSH daemon, run the following command: $ sudo systemctl restart sshd.service"
      }
    },
    "V-230300": {
      "tags": {
        "rid": "SV-230300r743959_rule"
      },
      "descs": {
        "check": "For systems that use UEFI, this is Not Applicable. Verify the /boot directory is mounted with the \"nosuid\" option with the following command: $ sudo mount | grep '\\s/boot\\s' /dev/sda1 on /boot type xfs (rw,nosuid,relatime,seclabe,attr2,inode64,noquota) If the /boot file system does not have the \"nosuid\" option set, this is a finding."
      }
    },
    "V-230318": {
      "tags": {
        "rid": "SV-230318r743960_rule"
      },
      "title": "All RHEL 8 world-writable directories must be owned by root, sys, bin, or an application user.",
      "desc": "If a world-writable directory is not owned by root, sys, bin, or an application User Identifier (UID), unauthorized users may be able to modify files created by others. The only authorized public directories are those temporary directories supplied with the system or those designed to be temporary file repositories. The setting is normally reserved for directories used by the system and by users for temporary file storage, (e.g., /tmp), and for directories requiring global read/write access."
    },
    "V-230319": {
      "tags": {
        "rid": "SV-230319r743961_rule"
      },
      "desc": "If a world-writable directory is not group-owned by root, sys, bin, or an application Group Identifier (GID), unauthorized users may be able to modify files created by others. The only authorized public directories are those temporary directories supplied with the system or those designed to be temporary file repositories. The setting is normally reserved for directories used by the system and by users for temporary file storage, (e.g., /tmp), and for directories requiring global read/write access."
    },
    "V-230322": {
      "tags": {
        "rid": "SV-230322r743963_rule"
      },
      "descs": {
        "check": "Verify the assigned home directory of all local interactive users is group-owned by that user’s primary GID with the following command: Note: This may miss local interactive users that have been assigned a privileged UID. Evidence of interactive use may be obtained from a number of log files containing system logon information. The returned directory \"/home/smithj\" is used as an example. $ sudo ls -ld $(awk -F: '($3&gt;=1000)&amp;&amp;($7 !~ /nologin/){print $6}' /etc/passwd) drwxr-x--- 2 smithj admin 4096 Jun 5 12:41 smithj Check the user's primary group with the following command: $ sudo grep $(grep smithj /etc/passwd | awk -F: ‘{print $4}’) /etc/group admin:x:250:smithj,jonesj,jacksons If the user home directory referenced in \"/etc/passwd\" is not group-owned by that user’s primary GID, this is a finding."
      }
    },
    "V-230333": {
      "tags": {
        "rid": "SV-230333r743966_rule",
        "fix_id": "F-32977r743965_fix"
      },
      "descs": {
        "check": "Note: This check applies to RHEL versions 8.2 or newer, if the system is RHEL version 8.0 or 8.1, this check is not applicable. Verify the \"/etc/security/faillock.conf\" file is configured to lock an account after three unsuccessful logon attempts: $ sudo grep 'deny =' /etc/security/faillock.conf deny = 3 If the \"deny\" option is not set to \"3\" or less (but not \"0\"), is missing or commented out, this is a finding.",
        "fix": "Configure the operating system to lock an account when three unsuccessful logon attempts occur. Add/Modify the \"/etc/security/faillock.conf\" file to match the following line: deny = 3"
      }
    },
    "V-230335": {
      "tags": {
        "rid": "SV-230335r743969_rule",
        "fix_id": "F-32979r743968_fix"
      },
      "descs": {
        "check": "Note: This check applies to RHEL versions 8.2 or newer, if the system is RHEL version 8.0 or 8.1, this check is not applicable. Verify the \"/etc/security/faillock.conf\" file is configured to lock an account after three unsuccessful logon attempts within 15 minutes: $ sudo grep 'fail_interval =' /etc/security/faillock.conf fail_interval = 900 If the \"fail_interval\" option is not set to \"900\" or more, is missing or commented out, this is a finding.",
        "fix": "Configure the operating system to lock an account when three unsuccessful logon attempts occur in 15 minutes. Add/Modify the \"/etc/security/faillock.conf\" file to match the following line: fail_interval = 900"
      }
    },
    "V-230337": {
      "tags": {
        "rid": "SV-230337r743972_rule",
        "fix_id": "F-32981r743971_fix"
      },
      "descs": {
        "check": "Note: This check applies to RHEL versions 8.2 or newer, if the system is RHEL version 8.0 or 8.1, this check is not applicable. Verify the \"/etc/security/faillock.conf\" file is configured to lock an account until released by an administrator after three unsuccessful logon attempts: $ sudo grep 'unlock_time =' /etc/security/faillock.conf unlock_time = 0 If the \"unlock_time\" option is not set to \"0\", is missing or commented out, this is a finding.",
        "fix": "Configure the operating system to lock an account until released by an administrator when three unsuccessful logon attempts occur in 15 minutes. Add/Modify the \"/etc/security/faillock.conf\" file to match the following line: unlock_time = 0"
      }
    },
    "V-230339": {
      "tags": {
        "rid": "SV-230339r743975_rule",
        "fix_id": "F-32983r743974_fix"
      },
      "descs": {
        "check": "Note: This check applies to RHEL versions 8.2 or newer. If the system is RHEL version 8.0 or 8.1, this check is not applicable. Verify the \"/etc/security/faillock.conf\" file is configured use a non-default faillock directory to ensure contents persist after reboot: $ sudo grep 'dir =' /etc/security/faillock.conf dir = /var/log/faillock If the \"dir\" option is not set to a non-default documented tally log directory, is missing or commented out, this is a finding.",
        "fix": "Configure the operating system maintain the contents of the faillock directory after a reboot. Add/Modify the \"/etc/security/faillock.conf\" file to match the following line: dir = /var/log/faillock"
      }
    },
    "V-230341": {
      "tags": {
        "rid": "SV-230341r743978_rule",
        "fix_id": "F-32985r743977_fix"
      },
      "descs": {
        "check": "Note: This check applies to RHEL versions 8.2 or newer, if the system is RHEL version 8.0 or 8.1, this check is not applicable. Verify the \"/etc/security/faillock.conf\" file is configured to prevent informative messages from being presented at logon attempts: $ sudo grep silent /etc/security/faillock.conf silent If the \"silent\" option is not set, is missing or commented out, this is a finding.",
        "fix": "Configure the operating system to prevent informative messages from being presented at logon attempts. Add/Modify the \"/etc/security/faillock.conf\" file to match the following line: silent"
      }
    },
    "V-230343": {
      "tags": {
        "rid": "SV-230343r743981_rule",
        "fix_id": "F-32987r743980_fix"
      },
      "descs": {
        "check": "Note: This check applies to RHEL versions 8.2 or newer, if the system is RHEL version 8.0 or 8.1, this check is not applicable. Verify the \"/etc/security/faillock.conf\" file is configured to log user name information when unsuccessful logon attempts occur: $ sudo grep audit /etc/security/faillock.conf audit If the \"audit\" option is not set, is missing or commented out, this is a finding.",
        "fix": "Configure the operating system to log user name information when unsuccessful logon attempts occur. Add/Modify the \"/etc/security/faillock.conf\" file to match the following line: audit"
      }
    },
    "V-230345": {
      "tags": {
        "rid": "SV-230345r743984_rule",
        "fix_id": "F-32989r743983_fix"
      },
      "descs": {
        "check": "Note: This check applies to RHEL versions 8.2 or newer, if the system is RHEL version 8.0 or 8.1, this check is not applicable. Verify the \"/etc/security/faillock.conf\" file is configured to log user name information when unsuccessful logon attempts occur: $ sudo grep even_deny_root /etc/security/faillock.conf even_deny_root If the \"even_deny_root\" option is not set, is missing or commented out, this is a finding.",
        "fix": "Configure the operating system to include root when locking an account after three unsuccessful logon attempts occur in 15 minutes. Add/Modify the \"/etc/security/faillock.conf\" file to match the following line: even_deny_root"
      }
    },
    "V-230348": {
      "tags": {
        "rid": "SV-230348r743987_rule",
        "fix_id": "F-32992r743986_fix"
      },
      "descs": {
        "check": "Verify the operating system enables the user to initiate a session lock with the following command: $ sudo grep -i lock-command /etc/tmux.conf set -g lock-command vlock If the \"lock-command\" is not set in the global settings to call \"vlock\", this is a finding.",
        "fix": "Configure the operating system to enable a user to initiate a session lock via tmux. Create a global configuration file \"/etc/tmux.conf\" and add the following line: set -g lock-command vlock"
      }
    },
    "V-230354": {
      "tags": {
        "rid": "SV-230354r743990_rule",
        "fix_id": "F-32998r743989_fix"
      },
      "title": "RHEL 8 must prevent a user from overriding the session lock-delay setting for the graphical user interface.",
      "descs": {
        "check": "Verify the operating system prevents a user from overriding settings for graphical user interfaces. Note: This requirement assumes the use of the RHEL 8 default graphical user interface, Gnome Shell. If the system does not have any graphical user interface installed, this requirement is Not Applicable. Determine which profile the system database is using with the following command: $ sudo grep system-db /etc/dconf/profile/user system-db:local Check that graphical settings are locked from non-privileged user modification with the following command: Note: The example below is using the database \"local\" for the system, so the path is \"/etc/dconf/db/local.d\". This path must be modified if a database other than \"local\" is being used. $ sudo grep -i lock-delay /etc/dconf/db/local.d/locks/* /org/gnome/desktop/screensaver/lock-delay If the command does not return at least the example result, this is a finding.",
        "fix": "Configure the operating system to prevent a user from overriding settings for graphical user interfaces. Create a database to contain the system-wide screensaver settings (if it does not already exist) with the following command: Note: The example below is using the database \"local\" for the system, so if the system is using another database in \"/etc/dconf/profile/user\", the file should be created under the appropriate subdirectory. $ sudo touch /etc/dconf/db/local.d/locks/session Add the following setting to prevent non-privileged users from modifying it: /org/gnome/desktop/screensaver/lock-delay"
      }
    },
    "V-230380": {
      "tags": {
        "rid": "SV-230380r743993_rule",
        "fix_id": "F-33024r743992_fix"
      },
      "title": "RHEL 8 must not allow accounts configured with blank or null passwords.",
      "descs": {
        "check": "To verify that null passwords cannot be used, run the following command: $ sudo grep -i permitemptypasswords /etc/ssh/sshd_config PermitEmptyPasswords no If \"PermitEmptyPasswords\" is set to \"yes\", this is a finding.",
        "fix": "Edit the following line in \"etc/ssh/sshd_config\" to prevent logons with empty passwords. PermitEmptyPasswords no The SSH daemon must be restarted for the changes to take effect. To restart the SSH daemon, run the following command: $ sudo systemctl restart sshd.service"
      }
    },
    "V-230387": {
      "tags": {
        "rid": "SV-230387r743996_rule",
        "fix_id": "F-33031r743995_fix"
      },
      "descs": {
        "check": "Verify that \"rsyslog\" is configured to log cron events with the following command: Note: If another logging package is used, substitute the utility configuration file for \"/etc/rsyslog.conf\" or \"/etc/rsyslog.d/*.conf\" files. $ sudo grep -s cron /etc/rsyslog.conf /etc/rsyslog.d/*.conf /etc/rsyslog.conf:*.info;mail.none;authpriv.none;cron.none /var/log/messages /etc/rsyslog.conf:# Log cron stuff /etc/rsyslog.conf:cron.* /var/log/cron If the command does not return a response, check for cron logging all facilities with the following command. $ sudo grep -s /var/log/messages /etc/rsyslog.conf /etc/rsyslog.d/*.conf /etc/rsyslog.conf:*.info;mail.none;authpriv.none;cron.none /var/log/messages If \"rsyslog\" is not logging messages for the cron facility or all facilities, this is a finding.",
        "fix": "Configure \"rsyslog\" to log all cron messages by adding or updating the following line to \"/etc/rsyslog.conf\" or a configuration file in the /etc/rsyslog.d/ directory: cron.* /var/log/cron The rsyslog daemon must be restarted for the changes to take effect: $ sudo systemctl restart rsyslog.service"
      }
    },
    "V-230391": {
      "tags": {
        "rid": "SV-230391r743998_rule",
        "fix_id": "F-33035r743997_fix"
      },
      "descs": {
        "fix": "Configure RHEL 8 to notify the System Administrator (SA) and Information System Security Officer (ISSO) when the audit storage volume is full by configuring the \"max_log_file_action\" parameter in the \"/etc/audit/auditd.conf\" file with the a value of \"syslog\" or \"keep_logs\": max_log_file_action = syslog"
      }
    },
    "V-230411": {
      "tags": {
        "rid": "SV-230411r744000_rule"
      },
      "title": "The RHEL 8 audit package must be installed.",
      "descs": {
        "check": "Verify the audit service is configured to produce audit records. Check that the audit service is installed with the following command: $ sudo yum list installed audit If the \"audit\" package is not installed, this is a finding."
      }
    },
    "V-230434": {
      "tags": {
        "rid": "SV-230434r744002_rule",
        "fix_id": "F-33078r744001_fix"
      },
      "descs": {
        "fix": "Configure the audit system to generate an audit event for any successful/unsuccessful use of the \"ssh-keysign\" by adding or updating the following rule in the \"/etc/audit/rules.d/audit.rules\" file: -a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F perm=x -F auid&gt;=1000 -F auid!=unset -k privileged-ssh The audit daemon must be restarted for the changes to take effect."
      }
    },
    "V-230469": {
      "tags": {
        "rid": "SV-230469r744004_rule"
      },
      "descs": {
        "check": "Verify RHEL 8 allocates a sufficient audit_backlog_limit to capture processes that start prior to the audit daemon with the following commands: $ sudo grub2-editenv - list | grep audit kernelopts=root=/dev/mapper/rhel-root ro crashkernel=auto resume=/dev/mapper/rhel-swap rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap rhgb quiet fips=1 audit=1 audit_backlog_limit=8192 boot=UUID=8d171156-cd61-421c-ba41-1c021ac29e82 If the \"audit_backlog_limit\" entry does not equal \"8192\" or greater, is missing, or the line is commented out, this is a finding. Check the audit_backlog_limit is set to persist in kernel updates: $ sudo grep audit /etc/default/grub GRUB_CMDLINE_LINUX=\"audit_backlog_limit=8192\" If \"audit_backlog_limit\" is not set to \"8192\" or greater, is missing or commented out, this is a finding."
      }
    },
    "V-230470": {
      "tags": {
        "rid": "SV-230470r744006_rule",
        "fix_id": "F-33114r744005_fix"
      },
      "descs": {
        "fix": "Configure RHEL 8 to enable Linux audit logging of the USBGuard daemon by adding or modifying the following line in \"/etc/usbguard/usbguard-daemon.conf\": AuditBackend=LinuxAudit"
      }
    },
    "V-230473": {
      "tags": {
        "rid": "SV-230473r744008_rule"
      },
      "descs": {
        "check": "Verify the audit tools are owned by \"root\" to prevent any unauthorized access, deletion, or modification. Check the owner of each audit tool by running the following command: $ sudo stat -c \"%U %n\" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/rsyslogd /sbin/augenrules root /sbin/auditctl root /sbin/aureport root /sbin/ausearch root /sbin/autrace root /sbin/auditd root /sbin/rsyslogd root /sbin/augenrules If any of the audit tools are not owned by \"root\", this is a finding."
      }
    },
    "V-230478": {
      "tags": {
        "rid": "SV-230478r744011_rule",
        "fix_id": "F-33122r744010_fix"
      },
      "desc": "Information stored in one location is vulnerable to accidental or incidental deletion or alteration. Off-loading is a common process in information systems with limited audit storage capacity. RHEL 8 installation media provides \"rsyslogd\". \"rsyslogd\" is a system utility providing support for message logging. Support for both internet and UNIX domain sockets enables this utility to support both local and remote logging. Couple this utility with \"rsyslog-gnutls\" (which is a secure communications library implementing the SSL, TLS and DTLS protocols), and you have a method to securely encrypt and off-load auditing. Rsyslog provides three ways to forward message: the traditional UDP transport, which is extremely lossy but standard; the plain TCP based transport, which loses messages only during certain situations but is widely available; and the RELP transport, which does not lose messages but is currently available only as part of the rsyslogd 3.15.0 and above. Examples of each configuration: UDP *.* @remotesystemname TCP *.* @@remotesystemname RELP *.* :omrelp:remotesystemname:2514 Note that a port number was given as there is no standard port for RELP.",
      "descs": {
        "check": "Verify the operating system has the packages required for encrypting offloaded audit logs installed with the following commands: $ sudo yum list installed rsyslog-gnutls rsyslog-gnutls.x86_64 8.1911.0-3.el8 @AppStream If the \"rsyslog-gnutls\" package is not installed, ask the administrator to indicate how audit logs are being encrypted during offloading and what packages are installed to support it. If there is no evidence of audit logs being encrypted during offloading, this is a finding.",
        "fix": "Configure the operating system to encrypt offloaded audit logs by installing the required packages with the following command: $ sudo yum install rsyslog-gnutls"
      }
    },
    "V-230483": {
      "tags": {
        "rid": "SV-230483r744014_rule",
        "fix_id": "F-33127r744013_fix"
      },
      "title": "RHEL 8 must take action when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity.",
      "descs": {
        "check": "Verify RHEL 8 takes action when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity with the following commands: $ sudo grep -w space_left /etc/audit/auditd.conf space_left = 25% If the value of the \"space_left\" keyword is not set to \"25%\" or if the line is commented out, ask the System Administrator to indicate how the system is providing real-time alerts to the SA and ISSO. If there is no evidence that real-time alerts are configured on the system, this is a finding.",
        "fix": "Configure the operating system to initiate an action to notify the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity by adding/modifying the following line in the /etc/audit/auditd.conf file. space_left = 25% Note: Option names and values in the auditd.conf file are case insensitive."
      }
    },
    "V-230496": {
      "tags": {
        "rid": "SV-230496r744017_rule",
        "fix_id": "F-33140r744016_fix"
      },
      "title": "RHEL 8 must disable the stream control transmission protocol (SCTP).",
      "descs": {
        "check": "Verify the operating system disables the ability to load the SCTP kernel module. $ sudo grep -ri SCTP /etc/modprobe.d/* | grep -i \"/bin/true\" install SCTP /bin/true If the command does not return any output, or the line is commented out, and use of the SCTP is not documented with the Information System Security Officer (ISSO) as an operational requirement, this is a finding. Verify the operating system disables the ability to use the SCTP. Check to see if the SCTP is disabled with the following command: $ sudo grep -ri SCTP /etc/modprobe.d/* | grep -i \"blacklist\" blacklist SCTP If the command does not return any output or the output is not \"blacklist SCTP\", and use of the SCTP is not documented with the Information System Security Officer (ISSO) as an operational requirement, this is a finding.",
        "fix": "Configure the operating system to disable the ability to use the SCTP kernel module. Add or update the following lines in the file \"/etc/modprobe.d/blacklist.conf\": install SCTP /bin/true blacklist SCTP Reboot the system for the settings to take effect."
      }
    },
    "V-230505": {
      "tags": {
        "rid": "SV-230505r744020_rule",
        "fix_id": "F-33149r744019_fix"
      },
      "descs": {
        "check": "Verify that \"firewalld\" is installed with the following commands: $ sudo yum list installed firewalld firewalld.noarch 0.7.0-5.el8 If the \"firewalld\" package is not installed, ask the System Administrator if another firewall is installed. If no firewall is installed this is a finding.",
        "fix": "Install \"firewalld\" with the following command: $ sudo yum install firewalld.noarch"
      }
    },
    "V-230523": {
      "tags": {
        "rid": "SV-230523r744023_rule",
        "fix_id": "F-33167r744022_fix"
      },
      "title": "The RHEL 8 fapolicy module must be installed.",
      "desc": "The organization must identify authorized software programs and permit execution of authorized software. The process used to identify software programs that are authorized to execute on organizational information systems is commonly referred to as whitelisting. Utilizing a whitelist provides a configuration management method for allowing the execution of only authorized software. Using only authorized software decreases risk by limiting the number of potential vulnerabilities. Verification of whitelisted software occurs prior to execution or at system startup. User home directories/folders may contain information of a sensitive nature. Non-privileged users should coordinate any sharing of information with an SA through shared resources. RHEL 8 ships with many optional packages. One such package is a file access policy daemon called \"fapolicyd\". \"fapolicyd\" is a userspace daemon that determines access rights to files based on attributes of the process and file. It can be used to either blacklist or whitelist processes or file access. Proceed with caution with enforcing the use of this daemon. Improper configuration may render the system non-functional. The \"fapolicyd\" API is not namespace aware and can cause issues when launching or running containers. ",
      "descs": {
        "check": "Verify the RHEL 8 \"fapolicyd\" is installed. Check that \"fapolicyd\" is installed with the following command: $ sudo yum list installed fapolicyd Installed Packages fapolicyd.x86_64 If fapolicyd is not installed, this is a finding.",
        "fix": "Install \"fapolicyd\" with the following command: $ sudo yum install fapolicyd.x86_64"
      }
    },
    "V-230524": {
      "tags": {
        "rid": "SV-230524r744026_rule",
        "fix_id": "F-33168r744025_fix"
      },
      "descs": {
        "check": "Verify the USBGuard has a policy configured with the following command: $ sudo usbguard list-rules If the command does not return results or an error is returned, ask the SA to indicate how unauthorized peripherals are being blocked. If there is no evidence that unauthorized peripherals are being blocked before establishing a connection, this is a finding.",
        "fix": "Configure the operating system to enable the blocking of unauthorized peripherals with the following command: This command must be run from a root shell and will create an allow list for any usb devices currently connect to the system. # usbguard generate-policy &gt; /etc/usbguard/rules.conf Note: Enabling and starting usbguard without properly configuring it for an individual system will immediately prevent any access over a usb device such as a keyboard or mouse"
      }
    },
    "V-230525": {
      "tags": {
        "rid": "SV-230525r744029_rule",
        "fix_id": "F-33169r744028_fix"
      },
      "descs": {
        "check": "Verify \"nftables\" is configured to allow rate limits on any connection to the system with the following command: Verify \"firewalld\" has \"nftables\" set as the default backend: $ sudo grep -i firewallbackend /etc/firewalld/firewalld.conf # FirewallBackend FirewallBackend=nftables If the \"nftables\" is not set as the \"firewallbackend\" default, this is a finding.",
        "fix": "Configure \"nftables\" to be the default \"firewallbackend\" for \"firewalld\" by adding or editing the following line in \"etc/firewalld/firewalld.conf\": FirewallBackend=nftables Establish rate-limiting rules based on organization-defined types of DoS attacks on impacted network interfaces."
      }
    },
    "V-230526": {
      "tags": {
        "rid": "SV-230526r744032_rule",
        "fix_id": "F-33170r744031_fix"
      },
      "descs": {
        "check": "Verify SSH is loaded and active with the following command: $ sudo systemctl status sshd sshd.service - OpenSSH server daemon Loaded: loaded (/usr/lib/systemd/system/sshd.service; enabled) Active: active (running) since Tue 2015-11-17 15:17:22 EST; 4 weeks 0 days ago Main PID: 1348 (sshd) CGroup: /system.slice/sshd.service 1053 /usr/sbin/sshd -D If \"sshd\" does not show a status of \"active\" and \"running\", this is a finding.",
        "fix": "Configure the SSH service to automatically start after reboot with the following command: $ sudo systemctl enable sshd.service"
      }
    },
    "V-230535": {
      "tags": {
        "rid": "SV-230535r744035_rule",
        "fix_id": "F-33179r744034_fix"
      },
      "title": "RHEL 8 must prevent IPv6 Internet Control Message Protocol (ICMP) redirect messages from being accepted.",
      "descs": {
        "check": "Verify RHEL 8 will not accept IPv6 ICMP redirect messages. Note: If IPv6 is disabled on the system, this requirement is Not Applicable. Check the value of the default \"accept_redirects\" variables with the following command: $ sudo sysctl net.ipv6.conf.default.accept_redirects net.ipv6.conf.default.accept_redirects = 0 If the returned line does not have a value of \"0\", a line is not returned, or the line is commented out, this is a finding.",
        "fix": "Configure RHEL 8 to prevent IPv6 ICMP redirect messages from being accepted with the following command: $ sudo sysctl -w net.ipv6.conf.default.accept_redirects=0 If \"0\" is not the system's default value then add or update the following line in the appropriate file under \"/etc/sysctl.d\": net.ipv6.conf.default.accept_redirects=0"
      }
    },
    "V-230536": {
      "tags": {
        "rid": "SV-230536r744037_rule"
      },
      "descs": {
        "check": "Verify RHEL 8 does not IPv4 ICMP redirect messages. Note: If IPv4 is disabled on the system, this requirement is Not Applicable. Check the value of the \"all send_redirects\" variables with the following command: $ sudo sysctl net.ipv4.conf.all.send_redirects net.ipv4.conf.all.send_redirects = 0 If the returned line does not have a value of \"0\", or a line is not returned, this is a finding."
      }
    },
    "V-230537": {
      "tags": {
        "rid": "SV-230537r744039_rule"
      },
      "descs": {
        "check": "Verify RHEL 8 does not respond to ICMP echoes sent to a broadcast address. Note: If IPv4 is disabled on the system, this requirement is Not Applicable. Check the value of the \"icmp_echo_ignore_broadcasts\" variable with the following command: $ sudo sysctl net.ipv4.icmp_echo_ignore_broadcasts net.ipv4.icmp_echo_ignore_broadcasts = 1 If the returned line does not have a value of \"1\", a line is not returned, or the retuned line is commented out, this is a finding."
      }
    },
    "V-230538": {
      "tags": {
        "rid": "SV-230538r744042_rule",
        "fix_id": "F-33182r744041_fix"
      },
      "title": "RHEL 8 must not forward IPv6 source-routed packets.",
      "descs": {
        "check": "Verify RHEL 8 does not accept IPv6 source-routed packets. Note: If IPv6 is disabled on the system, this requirement is Not Applicable. Check the value of the accept source route variable with the following command: $ sudo sysctl net.ipv6.conf.all.accept_source_route net.ipv6.conf.all.accept_source_route = 0 If the returned line does not have a value of \"0\", a line is not returned, or the line is commented out, this is a finding.",
        "fix": "Configure RHEL 8 to not forward IPv6 source-routed packets with the following command: $ sudo sysctl -w net.ipv6.conf.all.accept_source_route=0 If \"0\" is not the system's all value then add or update the following line in the appropriate file under \"/etc/sysctl.d\": net.ipv6.conf.all.accept_source_route=0"
      }
    },
    "V-230539": {
      "tags": {
        "rid": "SV-230539r744045_rule",
        "fix_id": "F-33183r744044_fix"
      },
      "title": "RHEL 8 must not forward IPv6 source-routed packets by default.",
      "descs": {
        "check": "Verify RHEL 8 does not accept IPv6 source-routed packets by default. Note: If IPv6 is disabled on the system, this requirement is Not Applicable. Check the value of the accept source route variable with the following command: $ sudo sysctl net.ipv6.conf.default.accept_source_route net.ipv6.conf.default.accept_source_route = 0 If the returned line does not have a value of \"0\", a line is not returned, or the line is commented out, this is a finding.",
        "fix": "Configure RHEL 8 to not forward IPv6 source-routed packets by default with the following command: $ sudo sysctl -w net.ipv6.conf.default.accept_source_route=0 If \"0\" is not the system's default value then add or update the following line in the appropriate file under \"/etc/sysctl.d\": net.ipv6.conf.default.accept_source_route=0"
      }
    },
    "V-230543": {
      "tags": {
        "rid": "SV-230543r744047_rule"
      },
      "descs": {
        "check": "Verify RHEL 8 does not allow interfaces to perform Internet Protocol version 4 (IPv4) ICMP redirects by default. Note: If IPv4 is disabled on the system, this requirement is Not Applicable. Check the value of the \"default send_redirects\" variables with the following command: $ sudo sysctl net.ipv4.conf.default.send_redirects net.ipv4.conf.default.send_redirects=0 If the returned line does not have a value of \"0\", or a line is not returned, this is a finding."
      }
    },
    "V-230544": {
      "tags": {
        "rid": "SV-230544r744050_rule",
        "fix_id": "F-33188r744049_fix"
      },
      "title": "RHEL 8 must ignore IPv6 Internet Control Message Protocol (ICMP) redirect messages.",
      "descs": {
        "check": "Verify RHEL 8 ignores IPv6 ICMP redirect messages. Note: If IPv6 is disabled on the system, this requirement is Not Applicable. Check the value of the \"accept_redirects\" variables with the following command: $ sudo sysctl net.ipv6.conf.all.accept_redirects net.ipv6.conf.all.accept_redirects = 0 If the returned line does not have a value of \"0\", a line is not returned, or the line is commented out, this is a finding.",
        "fix": "Configure RHEL 8 to ignore IPv6 ICMP redirect messages with the following command: $ sudo sysctl -w net.ipv6.conf.all.accept_redirects=0 If \"0\" is not the system's default value then add or update the following line in the appropriate file under \"/etc/sysctl.d\": net.ipv6.conf.all.accept_redirects = 0"
      }
    }
  }
}